<!DOCTYPE html>
<html>
<!-- <style>
		p {
    word-break: break-all;
    white-space: normal;
}
	</style> -->

<body onload="Welcome()">
	<script>
		function Welcome() {
			CS_SSP();
			CS_TCD();
			CS_TLI();
			CS_TO();
			CS_MA();
			CS_GRAD();
			CS_LC();
			CS_TSR();
			ChangeStatus();
			Sample_Key();
			ChangeStatus();
			Random_Key();
		}
	</script>
	<h1><u>RADIO PACKET DATA VERIFICATION </u></h1>
	<p class="a">Last updated on 23.02.2023 </p>
	<form id="KEY_DATA" style="border:orange; border-width:5px; border-style:solid;">
		<table>
			<tr id="Key_DATA">
				<center><b>SESSION KEY GENRATION WITH DIFFERENT KEYS AND MESSAGE </b></center>
			</tr>
			<tr>
				<td class="tdLabel"><label for="MessageBox" class="label">MESSAGE</label></td>
				<td><select name="MESSAGE" id="MESSAGE" onchange="Sample_Key()" style="width:200px">
						<option value="3243F6A8885A308D313198A2E0370734">MESSAGE1</option>
						<option value="A5A57AB9A5A57AB97AB9A5A57AB9A5A5">MESSAGE2</option>
						<option value="00112233445566778899aabbccddeeff">MESSAGE6</option>
						<option value="140BE7D01F920BD2404001F403FFFE00">MESSAGE3</option>
						<option value="520A1065A00000240780000000000000">MESSAGE4</option>
						<option value="2906024762E551F384F1009E081365C5">MESSAGE5</option>
					</select>
				</td>
				<td class="tdLabel"><label for="KEY" class="label">KEY</label></td>
				<td><select name="KEY" id="KEY" onchange="Sample_Key()" style="width:200px">
						<option value="2B7E151628AED2A6ABF7158809CF4F3C">KEY1</option>
						<option value="5468617473206D79204B756E67204675">KEY7</option>
						<option value="B711F0B63EAB37659EC2C4DD71A34FD9">KEY8</option>
						<option value="36763979244226452948404D63516654">KEY3</option>
						<option value="6250655368566D597133743676397924">KEY4</option>
						<option value="38792F423F4428472B4B625065536856">KEY5</option>
						<option value="7234753778214125442A472D4B614E64">KEY6</option>


					</select>
				</td>
			</tr>
		</table>
	</form>
	<button onclick="Sample_Key();ChangeStatus();">Submit</button>
	<p id="Session_Key"> </p>
	<script>
		var K_S;
		var PKT_H;
		var PKT_H_Length;
		var MA;
		var MA_Length;
		var TURNOUT;
		var TURNOUT_Length;

		function Sample_Key() {
			var k = document.getElementById("KEY_DATA");
			const Message_Text = "The Message is: ";
			const AKey_Text = "The Authentication Key is: ";
			var y = new BigNumber(k[0].value, 16);
			R = y;
			var y16 = y.toString(16).padStart(16, '0').toUpperCase();
			var yarray = toByteArray(y16);
			var x = new BigNumber(k[1].value, 16);
			var x16 = x.toString(16).padStart(16, '0').toUpperCase();
			var xarray = toByteArray(x16);
			var temp = cipher(yarray, xarray);


			document.getElementById("Session_Key").innerHTML =
				Message_Text
				+ R.toString(16).toUpperCase()
				+ "<br>" + AKey_Text + x16
				+ "<br> The Session Key in Hex is: "
				+ temp;
		}
	</script>
	<form id="RANDOM_DATA" style="border:orange; border-width:5px; border-style:solid;">
		<table>
			<tr id="RANDOM_DATA">
				<center><b>SESSION KEY GENRATION WITH LOCO AND STATION RANDOM NUMBERS </b></center>
			</tr>
			<tr id="RANDOM_ID_STN">
				<td class="tdLabel"><label for="RANDOM_ID_STN" class="label">Station Random Number in Hex: (Range: 2
						bytes) </label></td>
				<td><input type="text" name="RANDOM_ID_STN" min="0x0001" max="0xFFFF" value="A5A5" id="RANDOM_ID_STN"
						onchange="doForm()" style="width:200px" /></td>
				<td class="tdLabel"><label for="RANDOM_ID_LOCO" class="label">Loco Random Number in Hex: (Range: 2
						bytes) </label></td>
				<td><input type="text" name="RANDOM_ID_LOCO" min="0x0001" max="0xFFFF" value="7AB9" id="RANDOM_ID_LOCO"
						onchange="doForm()" style="width:200px" /></td>

			</tr>
			<tr>
				<td class="tdLabel"><label for="KEY" class="label">KEY</label></td>
				<td><select name="KEY" id="KEY" onchange="Random_Key()" style="width:200px">
						<option value="2B7E151628AED2A6ABF7158809CF4F3C">KEY1</option>
						<option value="5468617473206D79204B756E67204675">KEY7</option>
						<option value="B711F0B63EAB37659EC2C4DD71A34FD9">KEY8</option>
						<option value="36763979244226452948404D63516654">KEY3</option>
						<option value="6250655368566D597133743676397924">KEY4</option>
						<option value="38792F423F4428472B4B625065536856">KEY5</option>
						<option value="7234753778214125442A472D4B614E64">KEY6</option>
						<option value="000102030405060708090A0B0C0D0E0F">KEY2</option>
					</select>
				</td>
		</table>
	</form>
	<button onclick="Random_Key()">Submit</button>
	<p id="RandomSession_Key"> </p>

	<script>
		var TLI_LENGTH;
		var TCD_LENGTH;
		var SSP_LENGTH;
		var TLI;
		var TCD;
		var SSP;
		var GRAD_LENGTH;
		var GRAD;
		var LC_LENGTH;
		var LC;
		var MA_Length;
		var TSR_LENGTH;
		var TSR;
		function Random_Key() {
			var k = document.getElementById("RANDOM_DATA");
			const L_Random = "The Loco Random Number is: ";
			const S_Random = "The Station Random Number is: ";
			const R1_Random = "The R1 is: ";
			const R2_Random = "The R2 is: ";
			const R_Random = "The R is: ";
			const AKey_Text = "The Authentication Key is: ";
			var R_L = k[1].value.toString(16).padStart(4).toUpperCase();
			var R_S = k[0].value.toString(16).padStart(4).toUpperCase();
			var R1 = R_S + R_L + R_S + R_L;
			var R2 = R_L + R_S + R_L + R_S;
			var R = new BigNumber(R1 + R2, 16);
			var y16 = R.toString(16).padStart(16, '0').toUpperCase();
			var yarray = toByteArray(y16);
			yarray.reverse();
			var x = new BigNumber(k[2].value, 16);
			var x16 = x.toString(16).padStart(16, '0').toUpperCase();
			var xarray = toByteArray(x16);
			xarray.reverse();
			K_S = cipher(yarray, xarray);
			var Raw_Data = new BigNumber(TSR + LC + GRAD + SSP + TCD + TLI + TURNOUT + MA + PKT_H, 16);

			var R16 = Raw_Data.toString(16).padStart(16, '0').toUpperCase();

			var L2;
			L2 = R16.length / 2;

			var Adjusted_RawData = [L2];
			let j = 0;
			for (let i = 0; i < L2; i++) {
				Adjusted_RawData[i] = R16[j] + R16[j + 1];
				j += 2;
			}
			var L1 = Adjusted_RawData.length;

			Adjusted_RawData.reverse();
			var Rem = 16 - (L1 % 16);
			for (let i = 0; i < Rem; i++)
				Adjusted_RawData[L1 + i] = '00';
			var L_ARD = Adjusted_RawData.length;
			var MAC_Loop = Adjusted_RawData.length / 16;
			var MAC = [MAC_Loop];
			MAC[0] = K_S;
			var ARD = [16];
			for (let i = 1; i <= MAC_Loop; i++) {
				for (let j = 0; j < 16; j++)
					ARD[j] = Adjusted_RawData[(i - 1) * 16 + j];
				MAC[i] = cipher(ARD, MAC[i - 1]);
			}
			var MAC_Code = crc_calc(16, 0, MAC[2]);
			var MAC_CodeR = String_Reverse(MAC_Code);

			RD = new BigNumber(MAC_CodeR + TSR + LC + GRAD + SSP + TCD + TLI + TURNOUT + MA + PKT_H, 16);
			var M16 = RD.toString(16).toUpperCase();
			var Maced_RawData = [M16.length / 2];
			j = 0;
			for (let i = 0; i < M16.length / 2; i++) {
				Maced_RawData[i] = M16[j] + M16[j + 1];
				j += 2;
			}
			Maced_RawData.reverse();
			var L2 = Maced_RawData.length;
			var CRC32 = crc_calc(L2, 0, Maced_RawData);
			var CRC32R = String_Reverse(CRC32);
			var FD = new BigNumber(CRC32 + MAC_CodeR + TSR + LC + GRAD + SSP + TCD + TLI + TURNOUT + MA + PKT_H, 16);
			var FD16 = FD.toString(16).toUpperCase();
			var FD_Hex = [FD16.length / 2];
			j = 0;
			for (let i = 0; i < FD16.length / 2; i++) {
				FD_Hex[i] = FD16[j] + FD16[j + 1];
				j += 2;
			}
			FD_Hex.reverse();
			document.getElementById("RandomSession_Key").innerHTML = L_Random + R_L +
				"<br>" + S_Random + R_S + "<br>" +
				R1_Random + R1 + "<br>" + R2_Random + R2
				+ "<br> The Random Number R is: " + yarray
				+ "<br>" + AKey_Text + xarray
				+ "<br> The Session Key in Hex is: " + K_S
				+ "<br> The Unadjusted RawData is: " + R16
				+ "<br> The length of Unadjusted RawData is: " + L1
				+ "<br> The bytes adjustment of RawData is: " + L2
				+ "<br> The Adjusted RawData is: " + Adjusted_RawData
				+ "<br> The length of Adjusted RawData is: " + L_ARD
				+ "<br> The number of times MAC Loop to be run is: " + MAC_Loop
				// +"<br> The first level of Raw Data to be processed is: "+ ARD;
				+ "<br> The iterative MAC is: " + MAC
				+ "<br> The MAC Code is: " + MAC_Code
				+ "<br> The Reverse MAC Code is: " + MAC_CodeR
				+ "<br> The Raw_Data after insertion of MAC Code is: " + Maced_RawData
				+ "<br> The CRC 32 bit is: " + CRC32
				+ "<br> The final data is:" + FD_Hex;
		}
		function String_Reverse(n) {

			var temp = [];
			var j = 0;
			for (let i = 0; i < n.length / 2; i++) {
				temp[i] = n[j] + n[j + 1];
				j += 2;
			}
			temp.reverse();
			//F562E431
			return (temp.join(''));
		}
		var crc32_tbl =
			[0x00000000, 0x77073096, 0xEE0E612C, 0x990951BA, 0x076DC419, 0x706AF48F, 0xE963A535, 0x9E6495A3, 0x0EDB8832, 0x79DCB8A4,
				0xE0D5E91E, 0x97D2D988, 0x09B64C2B, 0x7EB17CBD, 0xE7B82D07, 0x90BF1D91, 0x1DB71064, 0x6AB020F2, 0xF3B97148, 0x84BE41DE,
				0x1ADAD47D, 0x6DDDE4EB, 0xF4D4B551, 0x83D385C7, 0x136C9856, 0x646BA8C0, 0xFD62F97A, 0x8A65C9EC, 0x14015C4F, 0x63066CD9,
				0xFA0F3D63, 0x8D080DF5, 0x3B6E20C8, 0x4C69105E, 0xD56041E4, 0xA2677172, 0x3C03E4D1, 0x4B04D447, 0xD20D85FD, 0xA50AB56B,
				0x35B5A8FA, 0x42B2986C, 0xDBBBC9D6, 0xACBCF940, 0x32D86CE3, 0x45DF5C75, 0xDCD60DCF, 0xABD13D59, 0x26D930AC, 0x51DE003A,
				0xC8D75180, 0xBFD06116, 0x21B4F4B5, 0x56B3C423, 0xCFBA9599, 0xB8BDA50F, 0x2802B89E, 0x5F058808, 0xC60CD9B2, 0xB10BE924,
				0x2F6F7C87, 0x58684C11, 0xC1611DAB, 0xB6662D3D, 0x76DC4190, 0x01DB7106, 0x98D220BC, 0xEFD5102A, 0x71B18589, 0x06B6B51F,
				0x9FBFE4A5, 0xE8B8D433, 0x7807C9A2, 0x0F00F934, 0x9609A88E, 0xE10E9818, 0x7F6A0DBB, 0x086D3D2D, 0x91646C97, 0xE6635C01,
				0x6B6B51F4, 0x1C6C6162, 0x856530D8, 0xF262004E, 0x6C0695ED, 0x1B01A57B, 0x8208F4C1, 0xF50FC457, 0x65B0D9C6, 0x12B7E950,
				0x8BBEB8EA, 0xFCB9887C, 0x62DD1DDF, 0x15DA2D49, 0x8CD37CF3, 0xFBD44C65, 0x4DB26158, 0x3AB551CE, 0xA3BC0074, 0xD4BB30E2,
				0x4ADFA541, 0x3DD895D7, 0xA4D1C46D, 0xD3D6F4FB, 0x4369E96A, 0x346ED9FC, 0xAD678846, 0xDA60B8D0, 0x44042D73, 0x33031DE5,
				0xAA0A4C5F, 0xDD0D7CC9, 0x5005713C, 0x270241AA, 0xBE0B1010, 0xC90C2086, 0x5768B525, 0x206F85B3, 0xB966D409, 0xCE61E49F,
				0x5EDEF90E, 0x29D9C998, 0xB0D09822, 0xC7D7A8B4, 0x59B33D17, 0x2EB40D81, 0xB7BD5C3B, 0xC0BA6CAD, 0xEDB88320, 0x9ABFB3B6,
				0x03B6E20C, 0x74B1D29A, 0xEAD54739, 0x9DD277AF, 0x04DB2615, 0x73DC1683, 0xE3630B12, 0x94643B84, 0x0D6D6A3E, 0x7A6A5AA8,
				0xE40ECF0B, 0x9309FF9D, 0x0A00AE27, 0x7D079EB1, 0xF00F9344, 0x8708A3D2, 0x1E01F268, 0x6906C2FE, 0xF762575D, 0x806567CB,
				0x196C3671, 0x6E6B06E7, 0xFED41B76, 0x89D32BE0, 0x10DA7A5A, 0x67DD4ACC, 0xF9B9DF6F, 0x8EBEEFF9, 0x17B7BE43, 0x60B08ED5,
				0xD6D6A3E8, 0xA1D1937E, 0x38D8C2C4, 0x4FDFF252, 0xD1BB67F1, 0xA6BC5767, 0x3FB506DD, 0x48B2364B, 0xD80D2BDA, 0xAF0A1B4C,
				0x36034AF6, 0x41047A60, 0xDF60EFC3, 0xA867DF55, 0x316E8EEF, 0x4669BE79, 0xCB61B38C, 0xBC66831A, 0x256FD2A0, 0x5268E236,
				0xCC0C7795, 0xBB0B4703, 0x220216B9, 0x5505262F, 0xC5BA3BBE, 0xB2BD0B28, 0x2BB45A92, 0x5CB36A04, 0xC2D7FFA7, 0xB5D0CF31,
				0x2CD99E8B, 0x5BDEAE1D, 0x9B64C2B0, 0xEC63F226, 0x756AA39C, 0x026D930A, 0x9C0906A9, 0xEB0E363F, 0x72076785, 0x05005713,
				0x95BF4A82, 0xE2B87A14, 0x7BB12BAE, 0x0CB61B38, 0x92D28E9B, 0xE5D5BE0D, 0x7CDCEFB7, 0x0BDBDF21, 0x86D3D2D4, 0xF1D4E242,
				0x68DDB3F8, 0x1FDA836E, 0x81BE16CD, 0xF6B9265B, 0x6FB077E1, 0x18B74777, 0x88085AE6, 0xFF0F6A70, 0x66063BCA, 0x11010B5C,
				0x8F659EFF, 0xF862AE69, 0x616BFFD3, 0x166CCF45, 0xA00AE278, 0xD70DD2EE, 0x4E048354, 0x3903B3C2, 0xA7672661, 0xD06016F7,
				0x4969474D, 0x3E6E77DB, 0xAED16A4A, 0xD9D65ADC, 0x40DF0B66, 0x37D83BF0, 0xA9BCAE53, 0xDEBB9EC5, 0x47B2CF7F, 0x30B5FFE9,
				0xBDBDF21C, 0xCABAC28A, 0x53B39330, 0x24B4A3A6, 0xBAD03605, 0xCDD70693, 0x54DE5729, 0x23D967BF, 0xB3667A2E, 0xC4614AB8,
				0x5D681B02, 0x2A6F2B94, 0xB40BBE37, 0xC30C8EA1, 0x5A05DF1B, 0x2D02EF8D];

		function crc_calc(cnt, crc, buf) {

			var tbl_idx = parseInt(buf[0], 16).toString(10);
			var arry_idx = 0;
			var calc_crc = 0x00000000;
			var temp2;
			var temp3;
			var temp1 = '';
			var x;
			temp1 = "The Initial CRC is: " + crc.toString(16);
			for (arry_idx = 0; arry_idx < cnt; arry_idx++) {
				temp1 += "<br> The tabel idx is: ";
				if (arry_idx > 0) {
					temp2 = parseInt(calc_crc, 10).toString(16).padStart(8, '0').substring(6);
					temp3 = parseInt(buf[arry_idx], 16).toString(10);
					tbl_idx = parseInt(temp2, 16).toString(10) ^ temp3;

					temp1 += temp2.toUpperCase() + "^" + buf[arry_idx] + "=";
				}
				calc_crc = (calc_crc >>> 8);
				temp1 += tbl_idx + ";";
				temp1 += "The CRC after 8-bit right shift is: " + calc_crc.toString(16).toUpperCase();
				calc_crc = (calc_crc ^ crc32_tbl[Number(tbl_idx)]);
				if (calc_crc < 0) {
					x = -calc_crc - 1;
					calc_crc = 0xFFFFFFFF - x;
				}

				temp1 += "; The crc32_tbl is: " + crc32_tbl[tbl_idx].toString(16).toUpperCase();
				temp1 += "; The crc32 is: " + calc_crc.toString(16).toUpperCase();

				//3529651594 & D262358A

			}
			//0x77073096
			//return(temp1);
			return (calc_crc.toString(16).padStart(8, '0').toUpperCase());

		}
		function invert(n) {
			var v = n;
			for (let i = 0; i < v.length; i++) {
				if (v[i] == 0)
					v[i] = 1;
				else
					v[i] = 0;
			}
			return (v);

		}

		function getRndInteger(min, max) {
			return Math.floor(Math.random() * (max - min)) + min;
		}
		function toHex(w) {
			var tmp = [16];
			for (let i = 0; i < 4; i++)
				for (let j = 0; j < 4; i++) {
					tmp[i * 4 + j] = i * 4 + j;
				}
			return tmp;
		}
		var sBox = [
			0x63, 0x7c, 0x77, 0x7b, 0xf2, 0x6b, 0x6f, 0xc5, 0x30, 0x01, 0x67, 0x2b, 0xfe, 0xd7, 0xab, 0x76,
			0xca, 0x82, 0xc9, 0x7d, 0xfa, 0x59, 0x47, 0xf0, 0xad, 0xd4, 0xa2, 0xaf, 0x9c, 0xa4, 0x72, 0xc0,
			0xb7, 0xfd, 0x93, 0x26, 0x36, 0x3f, 0xf7, 0xcc, 0x34, 0xa5, 0xe5, 0xf1, 0x71, 0xd8, 0x31, 0x15,
			0x04, 0xc7, 0x23, 0xc3, 0x18, 0x96, 0x05, 0x9a, 0x07, 0x12, 0x80, 0xe2, 0xeb, 0x27, 0xb2, 0x75,
			0x09, 0x83, 0x2c, 0x1a, 0x1b, 0x6e, 0x5a, 0xa0, 0x52, 0x3b, 0xd6, 0xb3, 0x29, 0xe3, 0x2f, 0x84,
			0x53, 0xd1, 0x00, 0xed, 0x20, 0xfc, 0xb1, 0x5b, 0x6a, 0xcb, 0xbe, 0x39, 0x4a, 0x4c, 0x58, 0xcf,
			0xd0, 0xef, 0xaa, 0xfb, 0x43, 0x4d, 0x33, 0x85, 0x45, 0xf9, 0x02, 0x7f, 0x50, 0x3c, 0x9f, 0xa8,
			0x51, 0xa3, 0x40, 0x8f, 0x92, 0x9d, 0x38, 0xf5, 0xbc, 0xb6, 0xda, 0x21, 0x10, 0xff, 0xf3, 0xd2,
			0xcd, 0x0c, 0x13, 0xec, 0x5f, 0x97, 0x44, 0x17, 0xc4, 0xa7, 0x7e, 0x3d, 0x64, 0x5d, 0x19, 0x73,
			0x60, 0x81, 0x4f, 0xdc, 0x22, 0x2a, 0x90, 0x88, 0x46, 0xee, 0xb8, 0x14, 0xde, 0x5e, 0x0b, 0xdb,
			0xe0, 0x32, 0x3a, 0x0a, 0x49, 0x06, 0x24, 0x5c, 0xc2, 0xd3, 0xac, 0x62, 0x91, 0x95, 0xe4, 0x79,
			0xe7, 0xc8, 0x37, 0x6d, 0x8d, 0xd5, 0x4e, 0xa9, 0x6c, 0x56, 0xf4, 0xea, 0x65, 0x7a, 0xae, 0x08,
			0xba, 0x78, 0x25, 0x2e, 0x1c, 0xa6, 0xb4, 0xc6, 0xe8, 0xdd, 0x74, 0x1f, 0x4b, 0xbd, 0x8b, 0x8a,
			0x70, 0x3e, 0xb5, 0x66, 0x48, 0x03, 0xf6, 0x0e, 0x61, 0x35, 0x57, 0xb9, 0x86, 0xc1, 0x1d, 0x9e,
			0xe1, 0xf8, 0x98, 0x11, 0x69, 0xd9, 0x8e, 0x94, 0x9b, 0x1e, 0x87, 0xe9, 0xce, 0x55, 0x28, 0xdf,
			0x8c, 0xa1, 0x89, 0x0d, 0xbf, 0xe6, 0x42, 0x68, 0x41, 0x99, 0x2d, 0x0f, 0xb0, 0x54, 0xbb, 0x16,
		];

		function cipher(input, w) {
			const Nb = 4;               // block size (in words): no of columns in state (fixed at 4 for AES)
			const Nr = 10;				//(w.length/Nb) - 1; // no of rounds: 10/12/14 for 128/192/256-bit keys

			let state = [[], [], [], []];  // initialise 4×Nb byte-array 'state' with input [§3.4]
			let wkey = [[], [], [], []];
			for (let i = 0; i < 4; i++)
				for (let j = 0; j < 4; j++) {
					state[j][i] = input[j + (i * 4)];
					wkey[j][i] = w[j + (i * 4)];
				}

			state = addRoundKey(state, wkey, 0, Nb);
			wkey = keyExpansion(w);

			for (let round = 1; round < Nr; round++) {
				state = subBytes(state, Nb);
				state = shiftRows(state, Nb);
				state = mixColumns(state, Nb);
				state = addRoundKey1(state, wkey, round, Nb);
			}

			state = subBytes(state, Nb);
			state = shiftRows(state, Nb);
			state = addRoundKey1(state, wkey, Nr, Nb);
			// convert state to 1-d array before returning [§3.4]
			const output = new Array(4 * Nb);
			let k = 0

			for (let i = 0; i < 4; i++)
				for (let j = 0; j < 4; j++) {
					output[k] = state[j][i];
					k++;
				}

			return output;
		}
		/*
		* Xor Round Key into state S [§5.1.4].
		*
		* @private
		*/
		function addRoundKey(state, wkey, rnd, Nb) {
			var k1;
			var k2;

			for (let r = 0; r < Nb; r++)
				for (let c = 0; c < Nb; c++) {
					k1 = parseInt(state[r][c], 16).toString(10);
					k2 = parseInt(wkey[r][c], 16).toString(10);
					state[r][c] = (k1 ^ k2).toString(16).padStart(2, '0').toUpperCase();

				}

			return state;
		}
		function addRoundKey1(state, wkey, rnd, Nb) {
			var k1;
			var k2;

			for (let r = 0; r < Nb; r++)
				for (let c = 0; c < Nb; c++) {
					k1 = parseInt(state[c][r], 16).toString(10);
					k2 = parseInt(wkey[r + (rnd * Nb)][c], 16).toString(10);
					state[c][r] = (k1 ^ k2).toString(16).padStart(2, '0').toUpperCase();

				}

			return state;
		}
		/*
			 * Perform key expansion to generate a key schedule from a cipher key [§5.2].
			 *
			 * @param   {number[]}   key - Cipher key as 16/24/32-byte array.
			 * @returns {number[][]} Expanded key schedule as 2D byte-array (Nr+1 × Nb bytes).
			 */
		function keyExpansion(key) {
			const Nb = 4;            // block size (in words): no of columns in state (fixed at 4 for AES)
			const Nk = key.length / 4; // key length (in words): 4/6/8 for 128/192/256-bit keys
			const Nr = Nk + 6;       // no of rounds: 10/12/14 for 128/192/256-bit keys

			const w = new Array(Nb * (Nr + 1));
			let temp = new Array(4);
			let temp1;
			let temp2 = new Array(4);
			let temp3 = new Array(4);
			let temp4 = new Array(4);
			let temp5 = new Array(4);
			var r1;
			var k1;
			var k2;
			var k3;
			var rnd = 0;
			var str = '';
			// initialise first Nk words of expanded key with cipher key
			for (let i = 0; i < Nk; i++) {
				const r = [key[4 * i], key[4 * i + 1], key[4 * i + 2], key[4 * i + 3]];
				w[i] = r;
			}
			let MAX = 40;
			// expand the key into the remainder of the schedule
			// for (let i=Nk; i<(Nb*(Nr+1)); i++) {
			for (let i = Nk; i < (Nk + MAX); i++) {
				w[i] = new Array(4);
				for (let t = 0; t < 4; t++) {
					temp[t] = w[i - 1][t];
					temp2[t] = w[i - 1][t];
				}


				//each Nk'th word has extra transformation
				if (i % Nk == 0) {
					temp = subWord(rotWord(temp));

					rnd++;


					k1 = parseInt(temp[0], 16).toString(10);
					temp1 = rnd;
					if (rnd == 1)
						k1 ^= 1;
					else if (rnd == 2)
						k1 ^= 2
					else if (rnd == 3)
						k1 ^= 4;
					else if (rnd == 4)
						k1 ^= 8;
					else if (rnd == 5)
						k1 ^= 16;
					else if (rnd == 6)
						k1 ^= 32;
					else if (rnd == 7)
						k1 ^= 64;
					else if (rnd == 8)
						k1 ^= 128;
					else if (rnd == 9)
						k1 ^= 27;
					else if (rnd == 10)
						k1 ^= 54;


					temp[0] = k1.toString(16).padStart(2, '0').toUpperCase();


				}
				temp3 = temp;
				// xor w[i] with w[i-1] and w[i-Nk]
				for (let t = 0; t < 4; t++) {
					k2 = parseInt(temp[t], 16);
					k3 = parseInt(w[i - Nk][t], 16);
					w[i][t] = (k2 ^ k3).toString(16).padStart(2, '0').toUpperCase();
					temp4[t] = w[i - Nk][t];
					temp5[t] = w[i][t];

				}
				/*str+=	"<br> Round: "+temp1+
				"<br> temp: "+temp2+
				"<br> After Subword: "+temp3 +
				"<br> w[i-Nk]: "+temp4
				+"<br> After XoR: "+temp5;*/

			}

			return (w);
		}


		/*
		 * Apply SBox to state S [§5.1.1].
		 *
		 * @private
		 */
		function subBytes(s, Nb) {
			for (let r = 0; r < 4; r++) {
				for (let c = 0; c < Nb; c++) s[r][c] = sBox[parseInt(s[r][c], 16)].toString(16).padStart(2).toUpperCase();
			}
			return s;
		}


		/*
		 * Shift row r of state S left by r bytes [§5.1.2].
		 *
		 * @private
		 */
		function shiftRows(s, Nb) {
			const t = new Array(4);
			for (let r = 1; r < 4; r++) {
				for (let c = 0; c < 4; c++) t[c] = parseInt(s[r][(c + r) % Nb], 16).toString(16).padStart(2, '0').toUpperCase();  // shift into temp copy
				for (let c = 0; c < 4; c++) s[r][c] = t[c];         // and copy back
			}          // note that this will work for Nb=4,5,6, but not 7,8 (always 4 for AES):
			return s;  // see asmaes.sourceforge.net/rijndael/rijndaelImplementation.pdf
		}


		/*
		 * Combine bytes of each col of state S [§5.1.3].
		 *
		 * @private
		 */
		function mixColumns(s, Nb) {
			for (let c = 0; c < Nb; c++) {
				const a = new Array(Nb);  // 'a' is a copy of the current column from 's'
				const b = new Array(Nb);  // 'b' is a•{02} in GF(2^8)
				var k;
				for (let r = 0; r < 4; r++) {
					k = parseInt(s[r][c], 16);
					a[r] = k;
					b[r] = k & 0x80 ? k << 1 ^ 0x011b : k << 1;
				}
				// a[n] ^ b[n] is a•{03} in GF(2^8)
				s[0][c] = (b[0] ^ a[1] ^ b[1] ^ a[2] ^ a[3]).toString(16).padStart(2, '0').toUpperCase(); // {02}•a0 + {03}•a1 + a2 + a3
				s[1][c] = (a[0] ^ b[1] ^ a[2] ^ b[2] ^ a[3]).toString(16).padStart(2, '0').toUpperCase(); // a0 • {02}•a1 + {03}•a2 + a3
				s[2][c] = (a[0] ^ a[1] ^ b[2] ^ a[3] ^ b[3]).toString(16).padStart(2, '0').toUpperCase(); // a0 + a1 + {02}•a2 + {03}•a3
				s[3][c] = (a[0] ^ b[0] ^ a[1] ^ a[2] ^ b[3]).toString(16).padStart(2, '0').toUpperCase(); // {03}•a0 + a1 + a2 + {02}•a3
			}
			return s;
		}





		/*
		 * Apply SBox to 4-byte word w.
		 *
		 * @private
		 */
		function subWord(w) {
			for (let i = 0; i < 4; i++) w[i] = sBox[parseInt(w[i], 16)].toString(16).padStart(2).toUpperCase();
			return w;
		}


		/*
		 * Rotate 4-byte word w left by one byte.
		 *
		 * @private
		 */
		function rotWord(w) {
			const tmp = w[0];
			for (let i = 0; i < 3; i++) w[i] = w[i + 1];
			w[3] = tmp;
			return w;
		}

		function toByteArray(w) {
			var tmp = [16];
			var j = 0;
			for (let i = 0; i < w.length / 2; i++) {
				tmp[i] = w[j] + w[j + 1];
				j += 2;
			}
			return tmp;
		}

	</script>

	<h2> PACKET HEADER </h2>
	<form id="SO_RPKT" style="border:orange; border-width:5px; border-style:solid;">
		<table>
			<tr>
				<td class="tdLabel"><label for="PKTTYPE" class="label">Packet Type:</label></td>
				<td><select name="PKT_TYPE" id="PKTTYPE" onchange="ChangeStatus()" style="width:300px">
						<option value="9">STATION TO ONBOARD REGULAR PACKET</option>
					</select>
				</td>
			<tr id="PKT_LEN">
				<td class="tdLabel"><label for="PKT_LEN" class="label">The Packet length in bytes is </label></td>
				<td><input type="number" name="PKT_LEN" min="0" max="1023" value="21" id="PKT_LEN"
						onchange="ChangeStatus()" style="width:200px" /></td>
			</tr>
			<tr id="FRAME_NUM">
				<td class="tdLabel"><label for="FRAME_NUM" class="label">Frame Number </label></td>
				<td><input type="number" name="FRAME_NUM" min="1" max="86400" value="86399" id="FRAME_NUM"
						onchange="ChangeStatus()" style="width:200px" /></td>
			</tr>

			<tr id="SRC_STN_ID">
				<td class="tdLabel"><label for="SRC_STN_ID" class="label">Source Station ID: (Range: 1 to 65535)
					</label></td>
				<td><input type="number" name="SRC_STN_ID" min="1" max="65535" value="514" id="SRC_STN_ID"
						onchange="ChangeStatus()" style="width:200px" /></td>
			</tr>

			<td class="tdLabel"><label for="STN_VER" class="label">Station Version </label></td>
			<td><select name="STN_VER" id="STN_VER" onchange="ChangeStatus()" style="width:200px">
					<option value="2">Kavach Spec 4.0</option>
					</tr>

					<tr id="DEST_LOCO_ID">
						<td class="tdLabel"><label for="DEST_LOCO_ID" class="label">Destination Loco ID: (Range: 1 to
								999999) </label></td>
						<td><input type="number" name="DEST_LOCO_ID" min="1" max="999999" value="74565"
								id="DEST_LOCO_ID" onchange="ChangeStatus()" style="width:200px" /></td>
					</tr>

					<tr id="REF_PROF_ID">
						<td class="tdLabel"><label for="REF_PROF_ID" class="label">Reference Profile ID: (Range: 0 to
								15) </label></td>
						<td><input type="number" name="REF_PROF_ID" min="0" max="15" value="0" id="REF_PROF_ID"
								onchange="ChangeStatus()" style="width:200px" /></td>
						<td class="tdlabel"> <label for="REF_PROF_ID" class="label"><b>NOTE:</b> This field shall be 0
								if no static packets are applicable </label></td>
					</tr>

					<tr id="LAST_REF_RFID">
						<td class="tdLabel"><label for="LAST_REF_RFID" class="label">Last Reference RFID: (Range: 0 to
								1024)</label></td>
						<td><input type="number" name="LAST_REF_RFID" min="1" max="1023" value="931" id="LAST_REF_RFID"
								onchange="ChangeStatus()" style="width:200px" /></td>
					</tr>
					<tr id="DIST_PKT_START">
						<td class="tdLabel"><label for="DIST_PKT_START" class="label">Distance Packet To Start: (Range:
								-16384 to 16383)</label></td>
						<td><input type="number" name="DIST_PKT_START" min="-16384" max="16383" value="0"
								id="DIST_PKT_START" onchange="ChangeStatus()" style="width:200px" /></td>
						<td class="tdlabel"> <label for="DIST_PKT_START" class="label"><b>NOTE:</b> This field shall be
								the distance from Last Reference RFID in meters </label></td>
					</tr>

					<tr id="PKT_DIR">
						<td class="tdLabel"><label for="PKT_DIR" class="label">Packet Direction</label></td>
						<td><select name="PKT_DIR" id="PKT_DIR" onchange="ChangeStatus()" style="width:200px">
								<option value="1">Nominal</option>
								<option value="2">Reverse</option>
								<option value="0">Unidentified</option>
							</select>
						</td>
					</tr>


		</table>
	</form>
	<button onclick="ChangeStatus()">Submit</button>
	<p id="R_Header"> </p>
	<h2> Movement Authority SubPacket </h2>
	<form id="MA_SUBPKT" style="border:orange; border-width:5px; border-style:solid;">
		<table id="MA_TABLE">
			<tr id="SUB_PKT_TYPE">
				<td class="tdLabel"><label for="SUB_PKT_TYPE" class="label">Sub Packet Type</label></td>
				<td><select name="SUB_PKT_TYPE" id="SUB_PKT_TYPE" onchange="CS_MA()" style="width:200px">
						<option value="0">MA</option>
					</select>
				</td>
			</tr>

			<tr id="SUB_PACKET_LEN">
				<td class="tdLabel"><label for="SUB_PACKET_LEN" class="label">Sub Packet Length </label></td>
				<td><input type="number" name="SUB_PACKET_LEN" min="1" max="128" value="19" id="SUB_PACKET_LEN"
						onchange="CS_MA()" style="width:200px" /></td>
			</tr>
			<tr id="FRAME_OFFSET">
				<td class="tdLabel"><label for="FRAME_OFFSET" class="label">FRAME_OFFSET</label></td>
				<td><select name="FRAME_OFFSET" id="FRAME_OFFSET" onchange="CS_MA()" style="width:200px">
						<option value="1">1</option>
						<option value="2">2</option>
						<option value="3">3</option>
						<option value="4">4</option>
						<option value="5">5</option>
						<option value="6">6</option>
						<option value="7">7</option>
						<option value="8">8</option>
						<option value="9">9</option>
						<option value="10">10</option>
						<option value="11">11</option>
						<option value="12">12</option>
						<option value="13">13</option>
						<option value="14">14</option>
					</select>
				</td>
			</tr>

			<tr id="DEST_LOCO_SOS">
				<td class="tdLabel"><label for="DEST_LOCO_SOS" class="label">Destionation Loco SoS</label></td>
				<td><select name="DEST_LOCO_SOS" id="DEST_LOCO_SOS" onchange="CS_MA()" style="width:200px">
						<option value="0">No SoS/Emergency</option>
						<option value="1">Foreign RFID</option>
						<option value="2">Reserved</option>
						<option value="3">On Board Error >= 120</option>
						<option value="4">Detection of SPAD</option>
						<option value="5">Rear End Collision</option>
						<option value="6">Head On Collision</option>
						<option value="7">Violation of Shunting Limits in Shunt Mode</option>
						<option value="8">Station General SoS</option>
					</select>
				</td>
			</tr>
			<tr id="TRAIN_SEC_TYPE">
				<td class="tdLabel"><label for="TRAIN_SEC_TYPE" class="label">Train Section Type</label></td>
				<td><select name="TRAIN_SEC_TYPE" id="TRAIN_SEC_TYPE" onchange="CS_MA()" style="width:200px">
						<option value="0">Station Section</option>
						<option value="1">Absolute Block</option>
						<option value="2">Auto Block</option>
						<option value="3">Reserved</option>
					</select>
				</td>
			</tr>
			<tr>
				<td class="tdLabel"> <b>Current Signal Status</b></td>
				<td class="tdLabel"> <b>Current Signal Line Number</b></td>
				<td class="tdLabel"> <b>
						<center>Current Signal Location</center>
					</b></td>
				<td class="tdLabel"> <b>
						<center>Current Signal Name</center>
					</b></td>
				<td class="tdLabel"> <b>
						<center>Override Required At</center>
					</b></td>
				<td class="tdLabel"> <b>
						<center>Is it a Stop Signal</center>
					</b></td>
				<td class="tdLabel"> <b>
						<center>Aspect of Signal</center>
					</b></td>
			<tr id="CUR_SIG_INFO">
				<td class="tdLabel"><label for="CUR_SIG_LINE_NO" class="label">Current Signal Information </label></td>
				<td><select name="CUR_SIG_LINE_NO" id="CUR_SIG_LINE_NO" onchange="CS_MA()" style="width:200px">
						<option value="0">Not applicable</option>
						<option value="1">Line 1</option>
						<option value="2">Line 2</option>
						<option value="3">Line 3</option>
						<option value="4">Line 4</option>
						<option value="5">Line 5</option>
						<option value="6">Line 6</option>
						<option value="7">Line 7</option>
						<option value="8">Line 8</option>
						<option value="9">Line 9</option>
						<option value="10">Line 10</option>
						<option value="11">Line 11</option>
						<option value="12">Line 12</option>
						<option value="13">Line 13</option>
						<option value="14">Line 14</option>
						<option value="15">Line 15</option>
						<option value="16">Line 16</option>
						<option value="17">Line 17</option>
						<option value="18">Line 18</option>
						<option value="19">Line 19</option>
						<option value="20">Line 20</option>
						<option value="21">Line 21</option>
						<option value="22">Line 22</option>
						<option value="23">Line 23</option>
						<option value="24">Line 24</option>
						<option value="25">Line 25</option>
						<option value="26">Line 26</option>
						<option value="27">Line 27</option>
						<option value="28">Line 28</option>
						<option value="29">Line 29</option>
						<option value="30">Goods line</option>
						<option value="31">Lines more than 30</option>
					</select>
				</td>
				<td><select name="SIG_LOC" id="SIG_LOC" onchange="CS_MA()" style="width:100px">
						<option value="0">Up Signal</option>
						<option value="1">Down Signal</option>
						<option value="2">Up Fast Signal</option>
						<option value="3">Down Fast Signal</option>
						<option value="4">Up Slow Signal</option>
						<option value="5">Down Slow Signal</option>
						<option value="6">Up Main Signal</option>
						<option value="7">Down Main Signal</option>
						<option value="8">Up Sub Signal</option>
						<option value="9">Down Sub Signal</option>
						<option value="10">Future</option>
					</select>
				</td>
				<td><select name="CUR_SIG_NAME" id="CUR_SIG_NAME" onchange="CS_MA()" style="width:200px">
						<option value="16">Distant</option>
						<option value="17">Inner Distant</option>
						<option value="18">Gate Distant</option>
						<option value="19">Gate Inner Distant</option>
						<option value="20">IB Distant</option>
						<option value="21">IB Inner Distant</option>
						<option value="22">Auto Signal</option>
						<option value="23">Semi Auto Signal with A marker</option>
						<option value="24">Main Home without Junction Route Indicator</option>
						<option value="25">Main Home with Junction Route Indicator</option>
						<option value="26">Routing Home without Junction Type Route indicator</option>
						<option value="27">Routing Home with Junction Type Route indicator</option>
						<option value="28">Main Line Starter</option>
						<option value="29">Loop Line Starter</option>
						<option value="30">Intermediate Starter</option>
						<option value="1">Advanced Starter</option>
						<option value="2">IB Signal</option>
						<option value="3">Gate Stop Signal</option>
						<option value="4">Calling On Signal</option>
						<option value="5">Advanced Starter Cum Gate Signal</option>
						<option value="6">Gate Cum Distant Signal</option>
						<option value="7">Advanced Starter Cum Distant Signal</option>
						<option value="35">Gate Stop Signal in Auto Territory</option>
						<option value="36">Semi Automatic Signal without A Marker</option>
						<option value="37">Advanced Starter Cum Gate inner Distant Signal</option>
						<option value="38">Gate Cum Inner Distant Signal</option>
						<option value="39">Gate Inner Distant Cum Distant Signal</option>
						<option value="40">IB Signal Cum Gate Distant Signal</option>
						<option value="41">IB Signal Cum Gate Inner Distant</option>
						<option value="42">Advanced Starter Cum IB Distant Signal</option>
						<option value="43">Starter Cum IB Distant Signal</option>
						<option value="44">Stop Board/Buffer Stop Signal</option>
						<option value="8">Only In RFID Tag, not in radio packet</option>
					</select>
				</td>
				<td> <select name="OVERRIDE" id="OVERRIDE" onchange="CS_MA()" style="width:150px">

						<option value="0">AT STANDSTILL</option>
						<option value="1">WHILE RUNNING</option>
					</select>
				</td>
				<td> <select name="STOPSIGNAL" id="STOPSIGNAL" onchange="CS_MA()" style="width:100px">

						<option value="0">NO</option>
						<option value="1">YES</option>
					</select>
				</td>
				<td><select name="CUR_SIG_ASP" id="CUR_SIG_ASP" onchange="CS_MA()" style="width:200px">

						<option value="1">Red</option>
						<option value="2">Yellow without display of route indication</option>
						<option value="3">Yellow with Position 1- Junction Type Route indicator(Left)</option>
						<option value="4">Yellow with Position 2- Junction Type Route indicator(Left)</option>
						<option value="5">Yellow with Position 3- Junction Type Route indicator(Left)</option>
						<option value="6">Yellow with Position 4- Junction Type Route indicator(Right)</option>
						<option value="7">Yellow with Position 5- Junction Type Route indicator(Right)</option>
						<option value="8">Yellow with Position 6- Junction Type Route indicator(Right)</option>
						<option value="10">Double Yellow</option>
						<option value="11">Green</option>
						<option value="15">Red with Calling on at Off</option>
						<option value="24">Stop Board/ Buffer Stop</option>
						<option value="0">Unidentified</option>
						<option value="12">Double Yellow with Position 1- Junction Type Route indication(Left)</option>
						<option value="13">Double Yellow with Position 4- Junction Type Route indication(Right)</option>
						<option value="32">Yellow with stencil Route 1</option>
						<option value="33">Yellow with stencil Route 2</option>
						<option value="34">Yellow with stencil Route 3</option>
						<option value="35">Yellow with stencil Route 4</option>
						<option value="36">Yellow with stencil Route 5</option>
						<option value="37">Yellow with stencil Route 6</option>
						<option value="38">Yellow with stencil Route 7</option>
						<option value="39">Yellow with stencil Route 8</option>
						<option value="40">Yellow with stencil Route 9</option>
						<option value="41">Yellow with stencil Route 10</option>
						<option value="42">Yellow with stencil Route 11</option>
						<option value="43">Yellow with stencil Route 12</option>
						<option value="44">Yellow with stencil Route 13</option>
						<option value="45">Yellow with stencil Route 14</option>
						<option value="46">Yellow with stencil Route 15</option>
						<option value="47">Yellow with stencil Route 16</option>
						<option value="48">Yellow with stencil Route 17</option>
						<option value="49">Yellow with stencil Route 18</option>
						<option value="50">Yellow with stencil Route 19 </option>
						<option value="51">Yellow with stencil Route 20</option>
						<option value="52">Yellow with stencil Route 21</option>
						<option value="53">Yellow with stencil Route 22</option>
						<option value="54">Yellow with stencil Route 23</option>
						<option value="55">Yellow with stencil Route 24</option>
						<option value="56">Yellow with stencil Route 25</option>
						<option value="57">Yellow with stencil Route 26</option>
						<option value="58">Yellow with stencil Route 27</option>
						<option value="59">Yellow with stencil Route 28</option>
						<option value="60">Yellow with stencil Route 29</option>
						<option value="61">Yellow with stencil Route 30</option>
						<option value="62">Yellow with stencil Route 31</option>
						<option value="63">Yellow with stencil Route 32</option>
					</select>
				</td>
			</tr>
			<tr id="NXT_SIG_ASP">
				<td class="tdLabel"><label for="NXT_SIG_ASP" class="label">Next Signal Aspect</label></td>
				<td><select name="NXT_SIG_ASP" id="NXT_SIG_ASP" onchange="CS_MA()" style="width:200px">
						<option value="1">Red</option>
						<option value="2">Yellow without display of route indication</option>
						<option value="3">Yellow with Position 1- Junction Type Route indicator(Left)</option>
						<option value="4">Yellow with Position 2- Junction Type Route indicator(Left)</option>
						<option value="5">Yellow with Position 3- Junction Type Route indicator(Left)</option>
						<option value="6">Yellow with Position 4- Junction Type Route indicator(Right)</option>
						<option value="7">Yellow with Position 5- Junction Type Route indicator(Right)</option>
						<option value="8">Yellow with Position 6- Junction Type Route indicator(Right)</option>
						<option value="10">Double Yellow</option>
						<option value="11">Green</option>
						<option value="15">Red with Calling on at Off</option>
						<option value="24">Stop Board/ Buffer Stop</option>
						<option value="0">Unidentified</option>
						<option value="12">Double Yellow with Position 1- Junction Type Route indication(Left)</option>
						<option value="13">Double Yellow with Position 4- Junction Type Route indication(Right)</option>
						<option value="32">Yellow with stencil Route 1</option>
						<option value="33">Yellow with stencil Route 2</option>
						<option value="34">Yellow with stencil Route 3</option>
						<option value="35">Yellow with stencil Route 4</option>
						<option value="36">Yellow with stencil Route 5</option>
						<option value="37">Yellow with stencil Route 6</option>
						<option value="38">Yellow with stencil Route 7</option>
						<option value="39">Yellow with stencil Route 8</option>
						<option value="40">Yellow with stencil Route 9</option>
						<option value="41">Yellow with stencil Route 10</option>
						<option value="42">Yellow with stencil Route 11</option>
						<option value="43">Yellow with stencil Route 12</option>
						<option value="44">Yellow with stencil Route 13</option>
						<option value="45">Yellow with stencil Route 14</option>
						<option value="46">Yellow with stencil Route 15</option>
						<option value="47">Yellow with stencil Route 16</option>
						<option value="48">Yellow with stencil Route 17</option>
						<option value="49">Yellow with stencil Route 18</option>
						<option value="50">Yellow with stencil Route 19 </option>
						<option value="51">Yellow with stencil Route 20</option>
						<option value="52">Yellow with stencil Route 21</option>
						<option value="53">Yellow with stencil Route 22</option>
						<option value="54">Yellow with stencil Route 23</option>
						<option value="55">Yellow with stencil Route 24</option>
						<option value="56">Yellow with stencil Route 25</option>
						<option value="57">Yellow with stencil Route 26</option>
						<option value="58">Yellow with stencil Route 27</option>
						<option value="59">Yellow with stencil Route 28</option>
						<option value="60">Yellow with stencil Route 29</option>
						<option value="61">Yellow with stencil Route 30</option>
						<option value="62">Yellow with stencil Route 31</option>
						<option value="63">Yellow with stencil Route 32</option>
					</select>
				</td>
			</tr>
			<tr id="APP_SIG_DIST">
				<td class="tdLabel"><label for="APP_SIG_DIST" class="label">Approaching Signal Distance</label></td>
				<td><input type="number" name="APP_SIG_DIST" min="0" max="32767" value="1500" id="APP_SIG_DIST"
						onchange="CS_MA()" style="width:200px" /></td>
			</tr>
			<tr id="AUTH_TYPE">
				<td class="tdLabel"><label for="AUTH_TYPE" class="label">Movement Authority Type</label></td>
				<td><select name="AUTH_TYPE2" id="AUTH_TYPE2" onchange="maChoiceMenu();CS_MA()" style="width:200px">
						<option value="1">OS MA</option>
						<option value="2">FS MA</option>
						<option value="3">Invalid MA</option>
					</select>
				</td>
			</tr>
			<tr id="AUTH_SPEED">
				<td class="tdLabel"><label for="AUTH_SPEED" class="label">Authorized Speed</label></td>
				<td><input type="number" name="AUTH_SPEED" min="0" max="250" value="60" id="AUTH_SPEED"
						onchange="CS_MA()" style="width:200px" /></td>
			</tr>
			<tr id="MAWRTSIG">
				<td class="tdLabel"><label for="MAWRTSIG" class="label">Movement Authority with respect to
						Signal</label></td>
				<td><input type="number" name="MAWRTSIG" min="0" max="65535" value="1500" id="MAWRTSIG"
						onchange="CS_MA()" style="width:200px" /></td>
			</tr>
		
			<tr id="REQ_SHORTEN_MA">
				<td class="tdLabel"><label for="REQ_SHORTEN_MA" class="label">Request Shorten MA</label></td>
				<td><select name="REQ_SHORTEN_MA" id="REQ_SHORTEN_MA2" onchange="maChoiceMenu();CS_MA()"
						style="width:200px">

						<option value="1">New Request from Trackside</option>
						<option value="0">No Request from Trackside</option>
					</select>
				</td>
			</tr>
			<tr id="NEWMA">
				<td class="tdLabel"><label for="NEWMA" class="label">New MA</label></td>
				<td><input type="number" name="NEWMA" min="0" max="65535" value="1500" id="NEWMA" onchange="CS_MA()"
						style="width:200px" /></td>
			</tr>
			<tr id="TRNLEN_INFO_STS">
				<td class="tdLabel"><label for="TRNLEN_INFO_STS" class="label">Train Length Info Status</label></td>
				<td><select name="TRNLEN_INFO_STS" id="TRNLEN_INFO_STS2" onchange="maChoiceMenu();CS_MA()"
						style="width:200px">

						<option value="1">Train Length Info Available</option>
						<option value="0">No Train Length Info</option>
					</select>
				</td>
			</tr>
			<tr id="TRNLEN_INFO_TYPE">
				<td class="tdLabel"><label for="TRNLEN_INFO_TYPE" class="label">Train Length Info Type</label></td>
				<td><select name="TRNLEN_INFO_TYPE" id="TRNLEN_INFO_TYPE" onchange="CS_MA()" style="width:200px">
						<option value="0">Reference Frame no of TL pertains to start frame</option>
						<option value="1">Reference Frame no of TL pertains to end frame</option>
					</select>
				</td>
			</tr>
			<tr id="REF_FRAME_TL">
				<td class="tdLabel"><label for="REF_FRAME_TL" class="label">REF FRAME TL MA</label></td>
				<td><input type="number" name="REF_FRAME_TL" min="0" max="86400" value="0" id="REF_FRAME_TL"
						onchange="CS_MA()" style="width:200px" /></td>
			</tr>
			<tr id="REF_OFFSET_TL">
				<td class="tdLabel"><label for="REF_OFFSET_TL" class="label">REF OFFSET TL</label></td>
				<td><input type="number" name="REF_OFFSET_TL" min="0" max="200" value="0" id="REF_OFFSET_TL"
						onchange="CS_MA()" style="width:200px" /></td>
			</tr>
			<tr id="NEXT_STN_COM">
				<td class="tdLabel"><label for="NEXT_STN_COM" class="label">NEXT STATION COM</label></td>
				<td><select name="NEXT_STN_COM" id="NEXT_STN_COM2" onchange="maChoiceMenu();CS_MA()"
						style="width:200px">

						<option value="1">Requires Next Station Handover</option>
						<option value="0">No Next Station Handover</option>
					</select>
				</td>
			</tr>
			<tr id="APP_STN_ID">
				<td class="tdLabel"><label for="APP_STN_ID" class="label">Approaching Station ID</label></td>
				<td><input type="number" name="APP_STN_ID" min="0" max="65535" value="503" id="APP_STN_ID"
						onchange="CS_MA()" style="width:200px" /></td>
			</tr>
		</table>
	</form>
	<button onclick="CS_MA();ChangeStatus();">Submit</button>
	<p id="MA_SPKT"> </p>

	<script>
		function CS_MA() {
			var x = document.getElementById("MA_SUBPKT");
			const Field_Length = [4, 7, 4, 4, 2, 5, 4, 6, 1, 1, 6, 6, 15, 2, 6, 16, 1, 1, 16, 1, 1, 17, 8, 1, 16];
			var DEC_Text = '';
			var BIN_Text = '';
			var Skip = 0;
			var Temp = 0;
			for (var i = 0; i <=x.length-1 ;i++) {
				DEC_Text += Number(x[i].value);
				if (i == 23 && x[22].value == 0) {
					Skip += 1;
				}
				else if (i == 21 && x[18].value == 0) {
					Skip += 1;
				}
				else if (i == 20 && x[18].value == 0) {
					Skip += 1;
				}
				else if (i == 19 && x[18].value == 0) {
					Skip += 1;
				}
				else if (i == 17 && x[16].value == 0) {
					Skip += 1;
				}
				else if (i == 13 && x[12].value != 1) {
					Skip += 1;
				}
				else {
					//BIN_Text+=decToBin(Number(x[i].value),Field_Length[i]);
					BIN_Text += Number(x[i].value).toString(2).padStart(Field_Length[i], '0');
				}
			}
			var Rem = BIN_Text.length % 8;
			if (Rem > 0) {
				var Pad = '0';
				for (var i = 0; i < 8 - Rem - 1; i++) {
					Pad += '0';
				}
				BIN_Text =  BIN_Text+Pad;
			}
			Skip = 0;
			var BIG_BIN = new BigNumber(BIN_Text, 2);
			var HEX_Text = BIG_BIN.toString(16);//.padStart(2,'0').toUpperCase();
			var PKT_LENGTH = (BIN_Text.length) / 8;
			x[1].value = PKT_LENGTH;
			var BIN2_Text = '';
			for (var i = 0; i <=x.length-1 ;i++) {
				DEC_Text += Number(x[i].value);
				if (i == 23 && x[22].value == 0) {
					Skip += 1;
				}
				else if (i == 21 && x[18].value == 0) {
					Skip += 1;
				}
				else if (i == 20 && x[18].value == 0) {
					Skip += 1;
				}
				else if (i == 19 && x[18].value == 0) {
					Skip += 1;
				}
				else if (i == 17 && x[16].value == 0) {
					Skip += 1;
				}
				else if (i == 13 && x[12].value != 1) {
					Skip += 1;
				}
				else {
					BIN2_Text += decToBin(Number(x[i].value), Field_Length[i]);
					//BIN_Text+=Number(x[i].value).toString(2).padStart(Field_Length[i],'0');
				}
			}
			var Rem = BIN2_Text.length % 8;
			if (Rem > 0) {
				Pad = '0';
				for (var i = 0; i < 8 - Rem - 1; i++) {
					Pad += '0';
				}
				BIN2_Text = BIN2_Text+Pad;
			}
			
			//Bin2_Text=Number(Bin2_Text).String(2).padStart(8,'0');
			BIG_BIN2 = new BigNumber(BIN2_Text, 2)
			HEX_Text = BIG_BIN2.toString(16).toUpperCase();
			
			PKT_LENGTH = (BIN2_Text.length) / 8;
			MA = HEX_Text;
			MA_Length = PKT_LENGTH;
			// document.getElementById("MA_SPKT").innerHTML = "The text in decimal is:"+DEC_Text+ "<br>" +"The Binary Text is: "+BIN_Text+"<br>"+BIN_Text.length+"<br>"+"No of Skips="+Skip+"<br>"+"The Hex Equivalent is: " +HEX_Text;
			document.getElementById("MA_SPKT").innerHTML =
				"The Binary Text is: " + BIN_Text + "<br>"
				+ "The No. of Bits are: " + BIN2_Text.length
				+ "<br> The No. of Bytes are: " + PKT_LENGTH +
				"<br>" + "Remainder is=" + Rem + "<br>" +
				"The Hex Equivalent is: " + MA;
			ChangeStatus();
		}

		var yid = 'binary-to-hex-converter';
		function pscm(e) {
			e.preventDefault && e.preventDefault();
			var t = document.getElementById("commentname").value, n = document.getElementById("commenttext").value;
			if (n.length > 2048) return alert("Sorry your comment is too long."), !1;
			var m = new XMLHttpRequest, o = "commentname=" + encodeURIComponent(t) + "&yid=" + encodeURIComponent(yid) + "&commenttext=" + encodeURIComponent(n); return m.open("POST", "/_yrme", !0), m.setRequestHeader("Content-type", "application/x-www-form-urlencoded"), m.onreadystatechange = function () { 4 === m.readyState && 200 === m.status ? (document.getElementById("message").innerHTML = "Your comment saved successfully and will be published after it is approved.", document.getElementById("commentname").value = "", document.getElementById("commenttext").value = "") : document.getElementById("message").innerHTML = "There was an error, please try again later.", document.getElementById("message").style.visibility = "visible" }, m.send(o), !1
		} document.getElementById("message").style.visibility = "hidden"; var frmcomment = document.getElementById("frmcomment"); frmcomment.attachEvent ? frmcomment.attachEvent("submit", pscm) : frmcomment.addEventListener("submit", pscm);

		/*function tagLinkingMenu() {
			var table = document.getElementById("TAG_LINKING_TABLE");
			var row = table.getElementsByTagName("tr");
			var choice = document.getElementById("ROUTE_RFID_CNT2");
			console.log("choice:"+choice.value);
			for (i = row.length; i > 5; i--) {

				row[5].remove();
			}
			for (i = 0; i < Number(choice.value); i++) {
				var x = document.createElement("tr");

				x.innerHTML = "<td class='tdLabel'><label for='DIST_NXT_RFID' class='label'>Distance of next RFID tag </label></td>				<td><input type='number' name='DIST_NXT_RFID" + (i + 1) + "' min='1' max='1023' value='761' id='DIST_NXT_RFID" + (i + 1) + "'						onchange='CS_TLI()' style='width:200px' /></td>				<td class='tdLabel'><label for='NXT_RFID_TAG_ID' class='label'>Next RFID tag ID </label></td>				<td><input type='number' name='NXT_RFID_TAG_ID" + (i + 1) + "' min='1' max='1023' value='999' id='NXT_RFID_TAG_ID" + (i + 1) + "'						onchange='CS_TLI()' style='width:200px' /></td>";

				table.appendChild(x);
			}

			var table2 = document.createElement("table");

			table2.innerHTML = "<tr id='ABS_LOC_RESET'>				<td class='tdLabel'><label for='ABS_LOC_RESET' class='label'>Absolute Location Reset </label></td>				<td><select name='ABS_LOC_RESET' id='ABS_LOC_RESET' onchange='CS_TLI()' style='width:200px'>						<option value='1'>Locational Error - positive</option>						<option value='0'>No Locational Error</option>						<option value='2'>Locational Error - negative</option>						<option value='3'>Location Reset</option>					</select>				</td>			</tr>			<tr id='START_DIST_TO_LOC_RESET'>				<td class='tdLabel'><label for='START_DIST_TO_LOC_RESET' class='label'>Start Distance of Normal Tag				</label></td>				<td><input type='number' name='START_DIST_TO_LOC_RESET' min='1' max='32768' value='19'						id='START_DIST_TO_LOC_RESET' onchange='CS_TLI()' style='width:200px' /></td>			</tr>			<tr id='ADJ_LOCO_DIR'>				<td class='tdLabel'><label for='ADJ_LOCO_DIR' class='label'>Adjacent loco direction </label></td>				<td><select name='ADJ_LOCO_DIR' id='ADJ_LOCO_DIR' onchange='CS_TLI()' style='width:200px'>						<option value='0'>Not known</option>						<option value='1'>Nominal</option>						<option value='2'>Reverse</option>						<option value='3'>Deduce from tags</option>					</select>				</td>			</tr>			<tr id='ABS_LOC_CORRECTION'>				<td class='tdLabel'><label for='ABS_LOC_CORRECTION' class='label'>New Absolute Location</label></td>				<td><input type='number' name='ABS_LOC_CORRECTION' min='1' max='8388608' value='19'						id='ABS_LOC_CORRECTION' onchange='CS_TLI()' style='width:200px' /></td>			</tr>			<tr id='ADJ_LINE_CNT'>				<td class='tdLabel'><label for='ADJ_LINE_CNT' class='label'>Adjacent line count</label></td>				<td><select name='ADJ_LINE_CNT' id='ADJ_LINE_CNT2' onchange='adjacentLineMenu();CS_TLI()' style='width:200px'>						<option value='0'>No adjacent lines, Self TIN will follow</option>						<option value='1'>1 adjacent line, excluding occupied self TIN</option>						<option value='2'>2 adjacent lines, excluding occupied self TIN</option>						<option value='3'>3 adjacent lines, excluding occupied self TIN</option>						<option value='4'>4 adjacent lines, excluding occupied self TIN</option>						<option value='5'>5 adjacent lines, excluding occupied self TIN</option>						<option value='6'>6 adjacent lines, excluding occupied self TIN</option>					</select>				</td>			</tr>			<tr id='LINE_TIN1'>				<td class='tdLabel'><label for='LINE_TIN' class='label'>Self TIN </label></td>				<td><input type='number' name='LINE_TIN1' min='1' max='512' value='251' id='LINE_TIN1'						onchange='CS_TLI()' style='width:200px' /></td>			</tr>";
			document.getElementById("TAG_LINKING_TABLE").appendChild(table2.firstChild);



		}*/

		function tagLinkingMenu() {
			var table = document.getElementById("TAG_LINKING_TABLE");
			var row = table.getElementsByTagName("tr");
			var choice = document.getElementById("ROUTE_RFID_CNT2");

			for (i = row.length; i > 4; i--) {

				row[4].remove();
			}
			for (i = 0; i < Number(choice.value); i++) {
				var x = document.createElement("tr");

				x.innerHTML = "<td class='tdLabel'><label for='DIST_NXT_RFID' class='label'>Distance of next RFID tag </label></td>				<td><input type='number' name='DIST_NXT_RFID" + (i + 1) + "' min='1' max='1023' value='761' id='DIST_NXT_RFID" + (i + 1) + "'						onchange='CS_TLI()' style='width:200px' /></td>				<td class='tdLabel'><label for='NXT_RFID_TAG_ID' class='label'>Next RFID tag ID </label></td>				<td><input type='number' name='NXT_RFID_TAG_ID" + (i + 1) + "' min='1' max='1023' value='999' id='NXT_RFID_TAG_ID" + (i + 1) + "'						onchange='CS_TLI()' style='width:200px' /></td>		<td class='tdLabel'><label for='DUP_TAG_DIR' class='label'>Duplicate Tag Direction w.r.t Main Tag</label></td><td><select name='DUP_TAG_DIR" + (i + 1) + "' id='DUP_TAG_DIR" + (i + 1) + "' onchange='CS_SSP()'						style='width:200px'>						<option value='0'>Duplicate Tag in Nominal Direction(+)</option>						<option value='1'>Duplicate Tag in Reverse Direction(-)</option>						</td>";

				table.appendChild(x);
			}

			var table2 = document.createElement("table");

			table2.innerHTML = "<tr id='ABS_LOC_RESET2'>				<td class='tdLabel'><label for='ABS_LOC_RESET' class='label'>Absolute Location Reset </label></td>				<td><select name='ABS_LOC_RESET' id='ABS_LOC_RESET' onchange='absLocResetMenu();CS_TLI()' style='width:200px'>														<option value='1'>Location Correction(New Section) </option>	<option value='0'>No Locational Error</option>								</select>				</td>			</tr>			<tr id='START_DIST_TO_LOC_RESET'>				<td class='tdLabel'><label for='START_DIST_TO_LOC_RESET' class='label'>Start Distance of Normal Tag				</label></td>				<td><input type='number' name='START_DIST_TO_LOC_RESET' min='1' max='32768' value='19'						id='START_DIST_TO_LOC_RESET' onchange='CS_TLI()' style='width:200px' /></td>			</tr>			<tr id='ADJ_LOCO_DIR'>				<td class='tdLabel'><label for='ADJ_LOCO_DIR' class='label'>Adjacent loco direction </label></td>				<td><select name='ADJ_LOCO_DIR' id='ADJ_LOCO_DIR' onchange='CS_TLI()' style='width:200px'>						<option value='0'>Not known</option>						<option value='1'>Nominal</option>						<option value='2'>Reverse</option>						<option value='3'>Deduce from tags</option>					</select>				</td>			</tr>			<tr id='ABS_LOC_CORRECTION'>				<td class='tdLabel'><label for='ABS_LOC_CORRECTION' class='label'>New Absolute Location</label></td>				<td><input type='number' name='ABS_LOC_CORRECTION' min='1' max='8388608' value='19'						id='ABS_LOC_CORRECTION' onchange='CS_TLI()' style='width:200px' /></td>			</tr>			<tr id='ADJ_LINE_CNT'>				<td class='tdLabel'><label for='ADJ_LINE_CNT' class='label'>Adjacent line count</label></td>				<td><select name='ADJ_LINE_CNT' id='ADJ_LINE_CNT2' onchange='adjacentLineMenu();CS_TLI()' style='width:200px'>						<option value='0'>No adjacent lines, Self TIN will follow</option>						<option value='1'>1 adjacent line, excluding occupied self TIN</option>						<option value='2'>2 adjacent lines, excluding occupied self TIN</option>						<option value='3'>3 adjacent lines, excluding occupied self TIN</option>						<option value='4'>4 adjacent lines, excluding occupied self TIN</option>						<option value='5'>5 adjacent lines, excluding occupied self TIN</option>						<option value='6'>6 adjacent lines, excluding occupied self TIN</option>					</select>				</td>			</tr>			<tr id='LINE_TIN1'>				<td class='tdLabel'><label for='LINE_TIN' class='label'>Self TIN </label></td>				<td><input type='number' name='LINE_TIN1' min='1' max='512' value='251' id='LINE_TIN1'						onchange='CS_TLI()' style='width:200px' /></td>			</tr>";
			document.getElementById("TAG_LINKING_TABLE").appendChild(table2.firstChild);

			document.call.ChangeStatus();
		}

	</script>


	<h2> Turnout Packet </h2>
	<form id="TO_SUBPKT" style="border:orange; border-width:5px; border-style:solid;">
		<table id="SUB_PKT_TYPE_TABLE">
			<tr id="SUB_PKT_TYPE">
				<td class="tdLabel"><label for="SUB_PKT_TYPE" class="label">Sub Packet Type</label></td>
				<td><select name="SUB_PKT_TYPE" id="SUB_PKT_TYPE" onchange="CS_TO()" style="width:200px">
						<option value="4">TO</option>
					</select>
				</td>
			</tr>

			<tr id="SUB_PACKET_LEN">
				<td class="tdLabel"><label for="SUB_PACKET_LEN" class="label">Sub Packet Length </label></td>
				<td><input type="number" name="SUB_PACKET_LEN" min="1" max="128" value="19" id="SUB_PACKET_LEN"
						onchange="CS_MA()" style="width:200px" /></td>
			</tr>


			<tr id="TO_CNT">
				<td class="tdLabel"><label for="TO_CNT" class="label">Turnout Count</label></td>
				<td><select name="TO_CNT" id="TO_CNT2" onchange="turnoutMenu();CS_TO();" style="width:200px">

						<option value="1">1 TURNOUT</option>
						<option value="0">NO TURNOUT</option>
						<option value="2">2 TURNOUTS</option>
						<option value="3">3 TURNOUTS</option>

					</select>
				</td>
			</tr>


			<tr id="TO_SPEED">
				<td class="tdLabel"><label for="TO_SPEED" class="label">Turn Out Speed</label></td>
				<td><select name="TO_SPEED1" id="TO_SPEED1" onchange="CS_TO()" style="width:200px">
						<option value="6">Upto 30 Kmph</option>
						<option value="3">Upto 15 Kmph</option>
						<option value="1">Upto 5 Kmph</option>
						<option value="2">Upto 10 Kmph</option>
						<option value="4">Upto 20 Kmph</option>
						<option value="5">Upto 25 Kmph</option>
						<option value="7">Upto 35 Kmph</option>
						<option value="8">Upto 40 Kmph</option>
						<option value="9">Upto 45 Kmph</option>
						<option value="10">Upto 50 Kmph</option>
						<option value="11">Upto 55 Kmph</option>
						<option value="12">Upto 60 Kmph</option>
						<option value="13">Upto 65 Kmph</option>
						<option value="14">Upto 70 KmphS</option>
						<option value="15">Upto 75 Kmph</option>
						<option value="16">Upto 80 Kmph</option>
						<option value="17">Upto 85 Kmph</option>
						<option value="18">Upto 90 Kmph</option>
						<option value="31">Unrestricted</option>
					</select>
				</td>
				<td id="DIFF_DIST_TO">
				<td class="tdLabel"><label for="DIFF_DIST_TO" class="label">Distance Of Turnout From Last Ref RFID
					</label></td>
				<td><input type="number" step="any" name="DIFF_DIST_TO1" min="0" max="32760" value="19000"
						id="DIFF_DIST_TO1" onchange="CS_TO()" style="width:200px" /></td>

				</td>

				<td id="TO_SPEED_REL_DIST">
				<td class="tdLabel"><label for="TO_SPEED_REL_DIST" class="label">Turnout Release Distance</label></td>
				<td><input type="number" name="TO_SPEED_REL_DIST1" min="0" max="4095" value="19" id="TO_SPEED_REL_DIST1"
						onchange="CS_TO()" style="width:200px" /></td>

				</td>
			</tr>

		</table>
	</form>
	<button onclick="CS_TO();ChangeStatus();">Submit</button>
	<p id="TO_SPKT"> </p>

	<h2> Tag Linking information Packet </h2>
	<form id="TLI_SUBPKT" style="border:orange; border-width:5px; border-style:solid;">
		<table id="TAG_LINKING_TABLE">
			<tr id="SUB_PKT_TYPE">
				<td class="tdLabel"><label for="SUB_PKT_TYPE" class="label">Sub Packet Type</label></td>
				<td><select name="SUB_PKT_TYPE" id="SUB_PKT_TYPE" onchange="CS_TLI()" style="width:200px">
						<option value="5">TLI</option>
					</select>
				</td>
			</tr>

			<tr id="SUB_PACKET_LEN">
				<td class="tdLabel"><label for="SUB_PACKET_LEN" class="label">Sub Packet Length </label></td>
				<td><input type="number" name="SUB_PACKET_LEN" min="1" max="128" value="127" id="SUB_PACKET_LEN"
						onchange="CS_TLI()" style="width:200px" /></td>
			</tr>

			<tr id="DIST_DUP_TAG">
				<td class="tdLabel"><label for="DIST_DUP_TAG" class="label">Distance between Main and Duplicate Tag:</label></td>
				<td><input type="number" name="DIST_DUP_TAG" min="0" max="47" value="1" id="DIST_DUP_TAG"
						onchange="CS_TLI()" style="width:200px" /></td>
			</tr>

			<tr id="ROUTE_RFID_CNT">
				<td class="tdLabel"><label for="ROUTE_RFID_CNT" class="label">Expected route RFID count  </label></td>
				<td><input type="number" name="ROUTE_RFID_CNT" min="0" max="15" value="1" id="ROUTE_RFID_CNT2"
						onchange="tagLinkingMenu();CS_TLI()" style="width:200px" /></td>
			</tr>
			

			<tr id="NXT_RFID1">
				<td class="tdLabel"><label for="DIST_NXT_RFID" class="label">Distance of next RFID tag </label></td>
				<td><input type="number" name="DIST_NXT_RFID1" min="1" max="1023" value="761" id="DIST_NXT_RFID1"
						onchange="CS_TLI()" style="width:200px" /></td>
				<td class="tdLabel"><label for="NXT_RFID_TAG_ID" class="label">Next RFID tag ID </label></td>
				<td><input type="number" name="NXT_RFID_TAG_ID1" min="1" max="1023" value="999" id="NXT_RFID_TAG_ID1"
						onchange="CS_TLI()" style="width:200px" /></td>

			<tr>
				<script type="text/javascript">
					tagLinkingMenu();

				</script>

		</table>
	</form>
	<button onclick="CS_TLI();ChangeStatus();">Submit</button>
	<p id="TLI_SBPKT"> </p>

	<h2> Track Condition Data </h2>
	<form id="TCD_SUBPKT" style="border:orange; border-width:5px; border-style:solid;">
		<table id="TCD_TABLE">
			<tr id="SUB_PKT_TYPE">
				<td class="tdLabel"><label for="SUB_PKT_TYPE" class="label">Sub Packet Type</label></td>
				<td><select name="SUB_PKT_TYPE" id="SUB_PKT_TYPE" onchange="CS_TCD()" style="width:200px">
						<option value="6">Track Condtion Data</option>
					</select>
				</td>
			</tr>

			<tr id="SUB_PACKET_LEN">
				<td class="tdLabel"><label for="SUB_PACKET_LEN" class="label">Sub Packet Length </label></td>
				<td><input type="number" name="SUB_PACKET_LEN" min="1" max="128" value="27" id="SUB_PACKET_LEN"
						onchange="CS_TCD()" style="width:200px" /></td>
			</tr>


			<tr id="TC_CNT">
				<td class="tdLabel"><label for="TC_CNT" class="label">Track condition Count</label></td>
				<td><input type="number" name="TC_CNT" min="1" max="16" value="1" id="TC_CNT2"
						onchange="trackConditionMenu();CS_TCD()" style="width:200px" /></td>
			</tr>


			<tr id="TC_TYPE">
				<td class="tdLabel"><label for="TC_TYPE" class="label">Track Condition type1</label></td>
				<td><select name="TC_TYPE1" id="TC_TYPE1" onchange="CS_TCD()" style="width:200px">
						<option value="5">Powerless Section</option>
						<option value="0">Not Used</option>
						<option value="1">Dead Stop</option>
						<option value="2">Radio Hole</option>
						<option value="3">Non Stopping Area</option>
						<option value="4">Tunnel Stopping Area</option>
						<option value="6">Sound Horn</option>
						<option value="7">Reversing Area</option>
						<option value="8">Fouling Mark Location</option>
					</select>

				</td>
				<td id="START_DIST_TC">
				<td class="tdLabel"><label for="START_DIST_TC" class="label">Start distance </label></td>
				<td><input type="number" name="START_DIST_TC1" min="1" max="32768" value="431" id="START_DIST_TC1"
						onchange="CS_TCD()" style="width:200px" /></td>

				</td>

				<td id="LENGTH_TC">
				<td class="tdLabel"><label for="LENGTH_TC" class="label">Length of track condition</label></td>
				<td><input type="number" name="LENGTH_TC" min="1" max="32768" value="31" id="LENGTH_TC"
						onchange="CS_TCD()" style="width:200px" /></td>
				</td>
			</tr>

		</table>
	</form>
	<button onclick="CS_TCD();ChangeStatus();">Submit</button>
	<p id="TCD_SPKT"> </p>
	<h2> Static Speed Profile</h2>
	<form id="SSP_SUBPKT" style="border:orange; border-width:5px; border-style:solid;">
		<table id="SPEED_INFO_TABLE">
			<tr id="SUB_PKT_TYPE">
				<td class="tdLabel"><label for="SUB_PKT_TYPE" class="label">Sub Packet Type</label></td>
				<td><select name="SUB_PKT_TYPE" id="SUB_PKT_TYPE" onchange="CS_SSP()" style="width:200px">
						<option value="4">SSP</option>
					</select>
				</td>
			</tr>

			<tr id="SUB_PACKET_LEN">
				<td class="tdLabel"><label for="SUB_PACKET_LEN" class="label">Sub Packet Length </label></td>
				<td><input type="number" name="SUB_PACKET_LEN" min="1" max="127" value="19" id="SUB_PACKET_LEN"
						onchange="CS_SSP()" style="width:200px" /></td>
			</tr>


			<tr id="LM_SPEED_INFO_CNT">
				<td class="tdLabel"><label for="LM_SPEED_INFO_CNT" class="label">Speed Info Count</label></td>
				<td><input type="number" name="LM_SPEED_INFO_CNT" min="1" max="31" value="1" id="LM_SPEED_INFO_CNT2"
						onchange="speedInfoMenu();CS_SSP()" style="width:200px" /></td>
			</tr>


			<tr id="LM_STATIC_SPEED_TYPE">
				

				<td class="tdLabel"><label for="LM_STATIC_SPEED_DIST" class="label">Static Speed Distance </label></td>
				<td><input type="number" step="any" name="LM_STATIC_SPEED_DIST1" min="0" max="32768" value="1900"
						id="LM_STATIC_SPEED_DIST1" onchange="CS_SSP()" style="width:200px" /></td>
				</td>

				<td class="tdLabel"><label for="LM_STATIC_SPEED_TYPE" class="label">Static Speed Type</label></td>
				<td><select name="LM_STATIC_SPEED_TYPE1" id="LM_STATIC_SPEED_TYPE1" onchange="CS_SSP()"
						style="width:200px">
						<option value="0">Universal Static Speed</option>
						<option value="1">Classified Speeds A,B,C will follow</option>
					</select>
				</td>

				<td class="tdLabel"><label for="LM_STATIC_SPEED_VALUE" class="label">Static Speed value</label></td>
				<td><input type="number" name="LM_STATIC_SPEED_VALUE1" min="1" max="50" value="19"
						id="LM_STATIC_SPEED_VALUE1" onchange="CS_SSP()" style="width:200px" /></td>
				</td>
			</tr>

		</table>
	</form>
	<button onclick="CS_SSP();ChangeStatus();">Submit</button>
	<p id="SSP_SPKT"> </p>


	<h2> Gradient Profile </h2>
	<form id="GRAD_SUBPKT" style="border:orange; border-width:5px; border-style:solid;">
		<table id="GRADIENT_TABLE">
			<tr id="SUB_PKT_TYPE">
				<td class="tdLabel"><label for="SUB_PKT_TYPE" class="label">Sub Packet Type</label></td>
				<td><select name="SUB_PKT_TYPE" id="SUB_PKT_TYPE" onchange="CS_GRAD()" style="width:200px">
						<option value="2">Gradient Profile</option>
					</select>
				</td>
			</tr>

			<tr id="SUB_PACKET_LEN">
				<td class="tdLabel"><label for="SUB_PACKET_LEN" class="label">Sub Packet Length </label></td>
				<td><input type="number" name="SUB_PACKET_LEN" min="1" max="128" value="27" id="SUB_PACKET_LEN"
						onchange="CS_GRAD()" style="width:200px" /></td>
			</tr>


			<tr id="GRAD_CNT">
				<td class="tdLabel"><label for="GRAD_CNT" class="label">Gradient Information Count</label></td>
				<td><input type="number" name="GRAD_CNT" min="0" max="31" value="1" id="GRAD_CNT2"
						onchange="gradientMenu();CS_GRAD()" style="width:200px" /></td>
			</tr>



			<tr>

				<td class="tdLabel"><label for="GRAD_DISTANCE" class="label">Gradient Distance 1(in meter) </label></td>
				<td><input type="number" name="GRAD_DISTANCE1" min="0" max="32760" value="500" id="GRAD_DISTANCE1"
						onchange="CS_GRAD()" style="width:200px" /></td>

				</td>

				<td class="tdLabel"><label for="GRAD_DIR" class="label">Gradient Type</label></td>
				<td><select name="GRAD_DIR1" id="GRAD_DIR1" onchange="CS_GRAD()" style="width:200px">
						<option value="0">Downhill</option>
						<option value="1">Uphill</option>

					</select>

				</td>

				<td class="tdLabel"><label for="GRAD_VALUE" class="label">Gradient Value(in meter)</label></td>
				<td><select name="GRAD_VALUE" id="GRAD_VALUE1" onchange="CS_GRAD()" style="width:200px">
						<option value="0">Gradient not steeper than 1 in 1000. Includes Level Gradient</option>
						<option value="1">Gradient from 1 in 1000 to not steeper than 1 in 500</option>
						<option value="2">Gradient from 1 in 500 to not steeper than 1 in 333</option>
						<option value="3">Gradient from 1 in 333 to not steeper than 1 in 250</option>
						<option value="4">Gradient from 1 in 250 to not steeper than 1 in 200</option>
						<option value="5">Gradient from 1 in 200 to not steeper than 1 in 166</option>
						<option value="6">Gradient from 1 in 166 to not steeper than 1 in 142</option>
						<option value="7">Gradient from 1 in 142 to not steeper than 1 in 125</option>
						<option value="8">Gradient from 1 in 125 to not steeper than 1 in 111</option>
						<option value="9">Gradient from 1 in 111 to not steeper than 1 in 100</option>
						<option value="10">Gradient from 1 in 100 to not steeper than 1 in 90</option>
						<option value="11">Gradient from 1 in 90 to not steeper than 1 in 83</option>
						<option value="12">Gradient from 1 in 83 to not steeper than 1 in 76</option>
						<option value="13">Gradient from 1 in 76 to not steeper than 1 in 71</option>
						<option value="14">Gradient from 1 in 71 to not steeper than 1 in 66</option>
						<option value="15">Gradient from 1 in 66 to not steeper than 1 in 62</option>
						<option value="16">Gradient from 1 in 62 to not steeper than 1 in 58</option>
						<option value="17">Gradient from 1 in 58 to not steeper than 1 in 55</option>
						<option value="18">Gradient from 1 in 55 to not steeper than 1 in 52</option>
						<option value="19">Gradient from 1 in 52 to not steeper than 1 in 50</option>
						<option value="20">Gradient from 1 in 50 to not steeper than 1 in 47</option>
						<option value="21">Gradient from 1 in 47 to not steeper than 1 in 45</option>
						<option value="22">Gradient from 1 in 45 to not steeper than 1 in 43</option>
						<option value="23">Gradient from 1 in 43 to not steeper than 1 in 41</option>
						<option value="24">Gradient from 1 in 41 to not steeper than 1 in 40</option>
						<option value="25">Gradient from 1 in 40 to not steeper than 1 in 38</option>
						<option value="26">Gradient from 1 in 38 to not steeper than 1 in 37</option>
						<option value="27">Gradient from 1 in 37 to not steeper than 1 in 35</option>
						<option value="28">Gradient from 1 in 35 to not steeper than 1 in 34</option>
						<option value="29">Gradient from 1 in 34 to not steeper than 1 in 33</option>
						<option value="30">Gradient steeper than 1 in 33</option>
					</select>
				</td>


			</tr>

		</table>
	</form>
	<button onclick="CS_GRAD();ChangeStatus();">Submit</button>
	<p id="GRAD_SPKT"> </p>




	<h2> LC Gate Profile </h2>
	<form id="LC_SUBPKT" style="border:orange; border-width:5px; border-style:solid;">
		<table id="LC_TABLE">
			<tr id="SUB_PKT_TYPE">
				<td class="tdLabel"><label for="SUB_PKT_TYPE" class="label">Sub Packet Type</label></td>
				<td><select name="SUB_PKT_TYPE" id="SUB_PKT_TYPE" onchange="CS_LC()" style="width:200px">
						<option value="3">LC Gate Profile</option>
					</select>
				</td>
			</tr>

			<tr id="SUB_PACKET_LEN">
				<td class="tdLabel"><label for="SUB_PACKET_LEN" class="label">Sub Packet Length </label></td>
				<td><input type="number" name="SUB_PACKET_LEN" min="1" max="128" value="27" id="SUB_PACKET_LEN"
						onchange="CS_LC()" style="width:200px" /></td>
			</tr>


			<tr id="TC_CNT">
				<td class="tdLabel"><label for="LC_CNT" class="label">LC Gate Information Count</label></td>
				<td><input type="number" name="LC_CNT" min="0" max="31" value="1" id="LC_CNT2"
						onchange="LCgateMenu();CS_LC()" style="width:200px" /></td>
			</tr>



			<tr>

				<td class="tdLabel"><label for="LC_DISTANCE" class="label">LC Gate 1 Distance(in meter) </label></td>
				<td><input type="number" name="LC_DISTANCE1" min="0" max="32760" value="500" id="GRAD_DISTANCE1"
						onchange="CS_LC()" style="width:200px" /></td>

				</td>
				<td class="tdLabel"><label for="LC_ID" class="label">LC Gate ID </label></td>
				<td><input type="number" name="LC_ID1" min="0" max="32760" value="500" id="LC_ID1" onchange="CS_LC()"
						style="width:200px" /></td>

				</td>

				<td class="tdLabel"><label for="LC_ALPHA" class="label">LC Gate ID(Alpha)</label></td>
				<td><select name="LC_ALPHA1" id="LC_ALPHA1" onchange="CS_LC()" style="width:200px">
						<option value="0">No suffix</option>
						<option value="1">a</option>
						<option value="2">b</option>
						<option value="3">c</option>
						<option value="4">d</option>
						<option value="5">e</option>
						<option value="6">Out of Range</option>

					</select>

				</td>
			</tr>
			<tr>
				<td class="tdLabel"><label for="LC_TYPE" class="label">LC Gate 1 Type</label></td>
				<td><select name="LC_TYPE1" id="LC_TYPE1" onchange="CS_LC()" style="width:200px">
						<option value="0">Manned</option>
						<option value="1">Unmanned</option>

					</select>

				</td>
				<td class="tdLabel"><label for="LC_CLASS" class="label">LC Gate 1 Class</label></td>
				<td><select name="LC_CLASS1" id="LC_CLASS1" onchange="CS_LC()" style="width:200px">
						<option value="0">Spacial</option>
						<option value="1">A</option>
						<option value="2">B1</option>
						<option value="3">B2</option>
						<option value="4">B</option>
						<option value="5">C</option>
						<option value="6">D</option>

					</select>

				</td>

				<td class="tdLabel"><label for="LC_WHIST_EN" class="label">Auto Whistling Enable </label></td>
				<td><select name="LC_WHIST_EN1" id="LC_WHIST_EN1" onchange="CS_LC()" style="width:200px">
						<option value="0">No</option>
						<option value="1">Yes</option>

					</select>
				</td>
				<td class="tdLabel"><label for="LC_WHIST_Type" class="label">Auto Whistling Type </label></td>
				<td><select name="LC_WHIST_Type1" id="LC_WHIST_Type1" onchange="CS_LC()" style="width:200px">
						<option value="0">Distance Based</option>
						<option value="1">Time Based</option>
						<option value="2">Configuration Pattern Based</option>

					</select>
				</td>



			</tr>

		</table>
	</form>
	<button onclick="CS_LC();ChangeStatus();">Submit</button>
	<p id="LC_SPKT"> </p>

	<h2> Temporary Speed Restrictions Profile </h2>
	<form id="TSR_SUBPKT" style="border:orange; border-width:5px; border-style:solid;">
		<table id="TSR_TABLE">
			<tr id="SUB_PKT_TYPE">
				<td class="tdLabel"><label for="SUB_PKT_TYPE" class="label">Sub Packet Type</label></td>
				<td><select name="SUB_PKT_TYPE" id="SUB_PKT_TYPE" onchange="CS_TSR()" style="width:200px">
						<option value="7">Temporary Speed Restrictions Profile</option>
					</select>
				</td>
			</tr>

			<tr id="SUB_PACKET_LEN">
				<td class="tdLabel"><label for="SUB_PACKET_LEN" class="label">Sub Packet Length </label></td>
				<td><input type="number" name="SUB_PACKET_LEN" min="1" max="128" value="27" id="SUB_PACKET_LEN"
						onchange="CS_TSR()" style="width:200px" /></td>
			</tr>


			<tr id="TSR_STATUS">
				<td class="tdLabel"><label for="TSR_STATUS" class="label">TSR Status</label></td>
				<td><select name="TSR_STATUS" id="TSR_STATUS" onchange="CS_TSR()" style="width:200px">
						<option value="0">No applicable TSR for the current MA</option>
						<option value="1">No Latest TSR Information</option>
						<option value="2">Latest TSR Information</option>

					</select>

				</td>

			</tr>

			<tr id="TSR_CNT">
				<td class="tdLabel"><label for="TSR_CNT" class="label">TSR Information Count</label></td>
				<td><input type="number" name="TSR_CNT" min="0" max="31" value="1" id="TSR_CNT2"
						onchange="TSRMenu();CS_TSR()" style="width:200px" /></td>
			</tr>


			<tr>

				<td class="tdLabel"><label for="TSR_ID1" class="label">TSR 1 ID</label></td>
				<td><input type="number" name="TSR_ID1" min="1" max="255" value="111" onchange="CS_TSR()"
						style="width:200px" /></td>

				<td class="tdLabel"><label for="TSR_Distance1" class="label">TSR Distance</label></td>
				<td><input type="number" name="TSR_Distance1" min="0" max="32760" value="300" onchange="CS_TSR()"
						style="width:200px" /></td>

				<td class="tdLabel"><label for="TSR_Length1" class="label">TSR Length</label></td>
				<td><input type="number" name="TSR_Length1" min="0" max="32760" value="301" onchange="CS_TSR()"
						style="width:200px" /></td>

			</tr>
			<tr>
				<td class="tdLabel"><label for="TSR_Class1" class="label">TSR 1 Class</label>
				</td>
				<td><select name="TSR_Class1" id="TSR_Class1" onchange="CS_TSR()" style="width:200px">
						<option value="0">Universal Speed</option>
						<option value="1">Classified Speed</option>

					</select>
				</td>

				<td class="tdLabel"><label for="TSR_Universal_Speed1" class="label">TSR Universal Speed</label></td>
				<td><input type="number" name="TSR_Universal_Speed1" min="0" max="40" value="5" onchange="CS_TSR()"
						style="width:200px" /></td>

				<td class="tdLabel"><label for="TSR_Whistle1" class="label">TSR Whistle</label>
				</td>
				<td><select name="TSR_Whistle" id="TSR_Whistle1" onchange="CS_TSR()" style="width:200px">
						<option value="0">No Whistle</option>
						<option value="1">Whistle blow</option>

					</select>
				</td>



			</tr>

		</table>
	</form>
	<button onclick="CS_LC();ChangeStatus();">Submit</button>
	<p id="TSR_SPKT"> </p>


	<script>
	//Start of ChangeStatus function
		function ChangeStatus() {
			var x = document.getElementById("SO_RPKT");
			const Field_Length = [4, 10, 17, 16, 3, 20, 4, 10, 15, 2];
			var DEC_Text = "";
			var BIN_Text = "";
			PKT_H_Length = MA_Length + TURNOUT_Length + 8;
			x[1].value = PKT_H_Length;
			for (var i = 0; i <=x.length-1 ;i++) {
				DEC_Text += Number(x[i].value);
				BIN_Text += decToBin(Number(x[i].value), Field_Length[i]);
			}
			var Rem = BIN_Text.length % 8;
			if (Rem > 0) {
				var Pad = "0";
				for (i = 0; i < 8 - Rem - 1; i++) {
					Pad += "0";
				}
				BIN_Text =  BIN_Text+Pad;
			}

			var BIG_BIN = new BigNumber(BIN_Text, 2);
			var HEX_Text = BIG_BIN.toString(16).padStart(16, '0').toUpperCase();
			var PKT_LENGTH = (BIN_Text.length) / 8;
			PKT_H = HEX_Text;
			PKT_H_Length = (MA_Length) + (TURNOUT_Length) + (TSR_LENGTH) + (LC_LENGTH) + (GRAD_LENGTH) + (SSP_LENGTH) + (TCD_LENGTH) + (TLI_LENGTH) + 13+8-1;

			x[1].value = PKT_H_Length;
			document.getElementById("R_Header").innerHTML =
				"The text in decimal is:" + DEC_Text + "<br>" +
				"The text in binary is:" + BIN_Text + "<br>" +
				"The No. of Bytes are: " + PKT_LENGTH + "<br>" +
				"The Text in Hex is: " + HEX_Text + "<br>" ;//+
				//"The Textlength in binary is:" + BIN_Text.length + "<br>" +
				//"The Textlength in Hex is: " + HEX_Text.length + "<br>" +
				//"The Textlength in bytes is: " + PKT_LENGTH + "<br>" +
				//" The remainder is: " + Rem;
		}

		function decToHex(number) {
			if (number < 0) {
				number = 0xFFFFFFFF + number + 1;
			}

			return number.toString(16).toUpperCase();
		}
		function decToBin(number, max_length) {
			var temp;
			var pad = '';
			var i;
			var j = 0;
			if (number < 0) {
				number = 0xFFFFFFFF + number + 1;
			}
			temp = number.toString(2).toUpperCase();
			if (temp.length < max_length) {
				for (i = temp.length; i < max_length; i++) {
					j = 1;
					pad += "0";
				}
			}
			if (j == 1) {
				temp = pad + temp;
			}

			return temp;
		}

		//************************************************************************
		function crc30cdma(p) {
			var i, j, c, bit;
			var crc, crc1, crc2;
			var crcVal = 0;
			var order = 30;
			var polynom = 0x2030b9c7;
			var crcinit = 0x3fffffff;
			var crcxor = 0x3fffffff;

			var crcmask;
			var crchighbit;
			var crcinit_direct;
			var crcinit_nondirect;
			var hex = [];
			var byteArray;

			//hex=p.split("");
			byteArray = p.match(new RegExp('.{1,' + 8 + '}', 'g'));

			for (j = 0; j < byteArray.length; j++) {
				hex[j] = parseInt(byteArray[j], 2).toString(10);

			}

			crcmask = 0x3fffffff;
			crchighbit = 0x20000000;
			crcinit_direct = crcinit;
			crc = crcinit_direct;
			for (i = 15; i >= 3; i--)
			//for (i=hex.length-1; i>0; i--) 
			{

				c = hex[i];
				for (j = 0x80; j; j = j >> 1) {

					bit = crc & crchighbit;
					crc = crc << 1;
					if (c & j)
						bit ^= crchighbit;
					if (bit)
						crc ^= polynom;
				}

			}

			crc ^= crcxor;
			crc &= crcmask;

			return (crc.toString(16));
		}


		function bin2hex(bin) {
			let hex = "";
			let bitsInHex = 17;

			for (let i = 0; i < bin.length; i = i + bitsInHex) {
				let eightBits = bin.substr(i, bitsInHex);
				let currentHex = (parseInt(eightBits, 2)).toString(16).toUpperCase();
				hex += currentHex;
			}

			return hex;
		}
	</script>
	<script>
		//Bignumber
		!function (e) { "use strict"; var r, x = /^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i, L = Math.ceil, U = Math.floor, I = "[BigNumber Error] ", T = I + "Number primitive has more than 15 significant digits: ", C = 1e14, M = 14, G = 9007199254740991, k = [1, 10, 100, 1e3, 1e4, 1e5, 1e6, 1e7, 1e8, 1e9, 1e10, 1e11, 1e12, 1e13], F = 1e7, q = 1e9; function j(e) { var r = 0 | e; return 0 < e || e === r ? r : r - 1 } function $(e) { for (var r, n, t = 1, i = e.length, o = e[0] + ""; t < i;) { for (r = e[t++] + "", n = M - r.length; n--; r = "0" + r); o += r } for (i = o.length; 48 === o.charCodeAt(--i);); return o.slice(0, i + 1 || 1) } function z(e, r) { var n, t, i = e.c, o = r.c, s = e.s, f = r.s, u = e.e, l = r.e; if (!s || !f) return null; if (n = i && !i[0], t = o && !o[0], n || t) return n ? t ? 0 : -f : s; if (s != f) return s; if (n = s < 0, t = u == l, !i || !o) return t ? 0 : !i ^ n ? 1 : -1; if (!t) return l < u ^ n ? 1 : -1; for (f = (u = i.length) < (l = o.length) ? u : l, s = 0; s < f; s++)if (i[s] != o[s]) return i[s] > o[s] ^ n ? 1 : -1; return u == l ? 0 : l < u ^ n ? 1 : -1 } function H(e, r, n, t) { if (e < r || n < e || e !== U(e)) throw Error(I + (t || "Argument") + ("number" == typeof e ? e < r || n < e ? " out of range: " : " not an integer: " : " not a primitive number: ") + String(e)) } function V(e) { var r = e.c.length - 1; return j(e.e / M) == r && e.c[r] % 2 != 0 } function W(e, r) { return (1 < e.length ? e.charAt(0) + "." + e.slice(1) : e) + (r < 0 ? "e" : "e+") + r } function X(e, r, n) { var t, i; if (r < 0) { for (i = n + "."; ++r; i += n); e = i + e } else if (++r > (t = e.length)) { for (i = n, r -= t; --r; i += n); e += i } else r < t && (e = e.slice(0, r) + "." + e.slice(r)); return e } (r = function e(r) { var v, a, h, n, l, s, f, u, c, g, t = B.prototype = { constructor: B, toString: null, valueOf: null }, w = new B(1), N = 20, O = 4, p = -7, d = 21, m = -1e7, y = 1e7, b = !1, o = 1, E = 0, A = { prefix: "", groupSize: 3, secondaryGroupSize: 0, groupSeparator: ",", decimalSeparator: ".", fractionGroupSize: 0, fractionGroupSeparator: "Â ", suffix: "" }, S = "0123456789abcdefghijklmnopqrstuvwxyz"; function B(e, r) { var n, t, i, o, s, f, u, l, c = this; if (!(c instanceof B)) return new B(e, r); if (null == r) { if (e && !0 === e._isBigNumber) return c.s = e.s, void (!e.c || e.e > y ? c.c = c.e = null : e.e < m ? c.c = [c.e = 0] : (c.e = e.e, c.c = e.c.slice())); if ((f = "number" == typeof e) && 0 * e == 0) { if (c.s = 1 / e < 0 ? (e = -e, -1) : 1, e === ~~e) { for (o = 0, s = e; 10 <= s; s /= 10, o++); return void (c.c = y < o ? c.e = null : (c.e = o, [e])) } l = String(e) } else { if (!x.test(l = String(e))) return h(c, l, f); c.s = 45 == l.charCodeAt(0) ? (l = l.slice(1), -1) : 1 } -1 < (o = l.indexOf(".")) && (l = l.replace(".", "")), 0 < (s = l.search(/e/i)) ? (o < 0 && (o = s), o += +l.slice(s + 1), l = l.substring(0, s)) : o < 0 && (o = l.length) } else { if (H(r, 2, S.length, "Base"), 10 == r) return D(c = new B(e), N + c.e + 1, O); if (l = String(e), f = "number" == typeof e) { if (0 * e != 0) return h(c, l, f, r); if (c.s = 1 / e < 0 ? (l = l.slice(1), -1) : 1, B.DEBUG && 15 < l.replace(/^0\.0*|\./, "").length) throw Error(T + e) } else c.s = 45 === l.charCodeAt(0) ? (l = l.slice(1), -1) : 1; for (n = S.slice(0, r), o = s = 0, u = l.length; s < u; s++)if (n.indexOf(t = l.charAt(s)) < 0) { if ("." == t) { if (o < s) { o = u; continue } } else if (!i && (l == l.toUpperCase() && (l = l.toLowerCase()) || l == l.toLowerCase() && (l = l.toUpperCase()))) { i = !0, s = -1, o = 0; continue } return h(c, String(e), f, r) } f = !1, -1 < (o = (l = a(l, r, 10, c.s)).indexOf(".")) ? l = l.replace(".", "") : o = l.length } for (s = 0; 48 === l.charCodeAt(s); s++); for (u = l.length; 48 === l.charCodeAt(--u);); if (l = l.slice(s, ++u)) { if (u -= s, f && B.DEBUG && 15 < u && (G < e || e !== U(e))) throw Error(T + c.s * e); if ((o = o - s - 1) > y) c.c = c.e = null; else if (o < m) c.c = [c.e = 0]; else { if (c.e = o, c.c = [], s = (o + 1) % M, o < 0 && (s += M), s < u) { for (s && c.c.push(+l.slice(0, s)), u -= M; s < u;)c.c.push(+l.slice(s, s += M)); s = M - (l = l.slice(s)).length } else s -= u; for (; s--; l += "0"); c.c.push(+l) } } else c.c = [c.e = 0] } function i(e, r, n, t) { var i, o, s, f, u; if (null == n ? n = O : H(n, 0, 8), !e.c) return e.toString(); if (i = e.c[0], s = e.e, null == r) u = $(e.c), u = 1 == t || 2 == t && (s <= p || d <= s) ? W(u, s) : X(u, s, "0"); else if (o = (e = D(new B(e), r, n)).e, f = (u = $(e.c)).length, 1 == t || 2 == t && (r <= o || o <= p)) { for (; f < r; u += "0", f++); u = W(u, o) } else if (r -= s, u = X(u, o, "0"), f < o + 1) { if (0 < --r) for (u += "."; r--; u += "0"); } else if (0 < (r += o - f)) for (o + 1 == f && (u += "."); r--; u += "0"); return e.s < 0 && i ? "-" + u : u } function R(e, r) { for (var n, t = 1, i = new B(e[0]); t < e.length; t++) { if (!(n = new B(e[t])).s) { i = n; break } r.call(i, n) && (i = n) } return i } function _(e, r, n) { for (var t = 1, i = r.length; !r[--i]; r.pop()); for (i = r[0]; 10 <= i; i /= 10, t++); return (n = t + n * M - 1) > y ? e.c = e.e = null : e.c = n < m ? [e.e = 0] : (e.e = n, r), e } function D(e, r, n, t) { var i, o, s, f, u, l, c, a = e.c, h = k; if (a) { e: { for (i = 1, f = a[0]; 10 <= f; f /= 10, i++); if ((o = r - i) < 0) o += M, s = r, c = (u = a[l = 0]) / h[i - s - 1] % 10 | 0; else if ((l = L((o + 1) / M)) >= a.length) { if (!t) break e; for (; a.length <= l; a.push(0)); u = c = 0, s = (o %= M) - M + (i = 1) } else { for (u = f = a[l], i = 1; 10 <= f; f /= 10, i++); c = (s = (o %= M) - M + i) < 0 ? 0 : u / h[i - s - 1] % 10 | 0 } if (t = t || r < 0 || null != a[l + 1] || (s < 0 ? u : u % h[i - s - 1]), t = n < 4 ? (c || t) && (0 == n || n == (e.s < 0 ? 3 : 2)) : 5 < c || 5 == c && (4 == n || t || 6 == n && (0 < o ? 0 < s ? u / h[i - s] : 0 : a[l - 1]) % 10 & 1 || n == (e.s < 0 ? 8 : 7)), r < 1 || !a[0]) return a.length = 0, t ? (r -= e.e + 1, a[0] = h[(M - r % M) % M], e.e = -r || 0) : a[0] = e.e = 0, e; if (0 == o ? (a.length = l, f = 1, l--) : (a.length = l + 1, f = h[M - o], a[l] = 0 < s ? U(u / h[i - s] % h[s]) * f : 0), t) for (; ;) { if (0 == l) { for (o = 1, s = a[0]; 10 <= s; s /= 10, o++); for (s = a[0] += f, f = 1; 10 <= s; s /= 10, f++); o != f && (e.e++, a[0] == C && (a[0] = 1)); break } if (a[l] += f, a[l] != C) break; a[l--] = 0, f = 1 } for (o = a.length; 0 === a[--o]; a.pop()); } e.e > y ? e.c = e.e = null : e.e < m && (e.c = [e.e = 0]) } return e } function P(e) { var r, n = e.e; return null === n ? e.toString() : (r = $(e.c), r = n <= p || d <= n ? W(r, n) : X(r, n, "0"), e.s < 0 ? "-" + r : r) } return B.clone = e, B.ROUND_UP = 0, B.ROUND_DOWN = 1, B.ROUND_CEIL = 2, B.ROUND_FLOOR = 3, B.ROUND_HALF_UP = 4, B.ROUND_HALF_DOWN = 5, B.ROUND_HALF_EVEN = 6, B.ROUND_HALF_CEIL = 7, B.ROUND_HALF_FLOOR = 8, B.EUCLID = 9, B.config = B.set = function (e) { var r, n; if (null != e) { if ("object" != typeof e) throw Error(I + "Object expected: " + e); if (e.hasOwnProperty(r = "DECIMAL_PLACES") && (H(n = e[r], 0, q, r), N = n), e.hasOwnProperty(r = "ROUNDING_MODE") && (H(n = e[r], 0, 8, r), O = n), e.hasOwnProperty(r = "EXPONENTIAL_AT") && ((n = e[r]) && n.pop ? (H(n[0], -q, 0, r), H(n[1], 0, q, r), p = n[0], d = n[1]) : (H(n, -q, q, r), p = -(d = n < 0 ? -n : n))), e.hasOwnProperty(r = "RANGE")) if ((n = e[r]) && n.pop) H(n[0], -q, -1, r), H(n[1], 1, q, r), m = n[0], y = n[1]; else { if (H(n, -q, q, r), !n) throw Error(I + r + " cannot be zero: " + n); m = -(y = n < 0 ? -n : n) } if (e.hasOwnProperty(r = "CRYPTO")) { if ((n = e[r]) !== !!n) throw Error(I + r + " not true or false: " + n); if (n) { if ("undefined" == typeof crypto || !crypto || !crypto.getRandomValues && !crypto.randomBytes) throw b = !n, Error(I + "crypto unavailable"); b = n } else b = n } if (e.hasOwnProperty(r = "MODULO_MODE") && (H(n = e[r], 0, 9, r), o = n), e.hasOwnProperty(r = "POW_PRECISION") && (H(n = e[r], 0, q, r), E = n), e.hasOwnProperty(r = "FORMAT")) { if ("object" != typeof (n = e[r])) throw Error(I + r + " not an object: " + n); A = n } if (e.hasOwnProperty(r = "ALPHABET")) { if ("string" != typeof (n = e[r]) || /^.$|[+-.\s]|(.).*\1/.test(n)) throw Error(I + r + " invalid: " + n); S = n } } return { DECIMAL_PLACES: N, ROUNDING_MODE: O, EXPONENTIAL_AT: [p, d], RANGE: [m, y], CRYPTO: b, MODULO_MODE: o, POW_PRECISION: E, FORMAT: A, ALPHABET: S } }, B.isBigNumber = function (e) { if (!e || !0 !== e._isBigNumber) return !1; if (!B.DEBUG) return !0; var r, n, t = e.c, i = e.e, o = e.s; e: if ("[object Array]" == {}.toString.call(t)) { if ((1 === o || -1 === o) && -q <= i && i <= q && i === U(i)) { if (0 === t[0]) { if (0 === i && 1 === t.length) return !0; break e } if ((r = (i + 1) % M) < 1 && (r += M), String(t[0]).length == r) { for (r = 0; r < t.length; r++)if ((n = t[r]) < 0 || C <= n || n !== U(n)) break e; if (0 !== n) return !0 } } } else if (null === t && null === i && (null === o || 1 === o || -1 === o)) return !0; throw Error(I + "Invalid BigNumber: " + e) }, B.maximum = B.max = function () { return R(arguments, t.lt) }, B.minimum = B.min = function () { return R(arguments, t.gt) }, B.random = (n = 9007199254740992, l = Math.random() * n & 2097151 ? function () { return U(Math.random() * n) } : function () { return 8388608 * (1073741824 * Math.random() | 0) + (8388608 * Math.random() | 0) }, function (e) { var r, n, t, i, o, s = 0, f = [], u = new B(w); if (null == e ? e = N : H(e, 0, q), i = L(e / M), b) if (crypto.getRandomValues) { for (r = crypto.getRandomValues(new Uint32Array(i *= 2)); s < i;)9e15 <= (o = 131072 * r[s] + (r[s + 1] >>> 11)) ? (n = crypto.getRandomValues(new Uint32Array(2)), r[s] = n[0], r[s + 1] = n[1]) : (f.push(o % 1e14), s += 2); s = i / 2 } else { if (!crypto.randomBytes) throw b = !1, Error(I + "crypto unavailable"); for (r = crypto.randomBytes(i *= 7); s < i;)9e15 <= (o = 281474976710656 * (31 & r[s]) + 1099511627776 * r[s + 1] + 4294967296 * r[s + 2] + 16777216 * r[s + 3] + (r[s + 4] << 16) + (r[s + 5] << 8) + r[s + 6]) ? crypto.randomBytes(7).copy(r, s) : (f.push(o % 1e14), s += 7); s = i / 7 } if (!b) for (; s < i;)(o = l()) < 9e15 && (f[s++] = o % 1e14); for (i = f[--s], e %= M, i && e && (o = k[M - e], f[s] = U(i / o) * o); 0 === f[s]; f.pop(), s--); if (s < 0) f = [t = 0]; else { for (t = -1; 0 === f[0]; f.splice(0, 1), t -= M); for (s = 1, o = f[0]; 10 <= o; o /= 10, s++); s < M && (t -= M - s) } return u.e = t, u.c = f, u }), B.sum = function () { for (var e = 1, r = arguments, n = new B(r[0]); e < r.length;)n = n.plus(r[e++]); return n }, a = function () { var d = "0123456789"; function m(e, r, n, t) { for (var i, o, s = [0], f = 0, u = e.length; f < u;) { for (o = s.length; o--; s[o] *= r); for (s[0] += t.indexOf(e.charAt(f++)), i = 0; i < s.length; i++)s[i] > n - 1 && (null == s[i + 1] && (s[i + 1] = 0), s[i + 1] += s[i] / n | 0, s[i] %= n) } return s.reverse() } return function (e, r, n, t, i) { var o, s, f, u, l, c, a, h, g = e.indexOf("."), p = N, w = O; for (0 <= g && (u = E, E = 0, e = e.replace(".", ""), c = (h = new B(r)).pow(e.length - g), E = u, h.c = m(X($(c.c), c.e, "0"), 10, n, d), h.e = h.c.length), f = u = (a = m(e, r, n, i ? (o = S, d) : (o = d, S))).length; 0 == a[--u]; a.pop()); if (!a[0]) return o.charAt(0); if (g < 0 ? --f : (c.c = a, c.e = f, c.s = t, a = (c = v(c, h, p, w, n)).c, l = c.r, f = c.e), g = a[s = f + p + 1], u = n / 2, l = l || s < 0 || null != a[s + 1], l = w < 4 ? (null != g || l) && (0 == w || w == (c.s < 0 ? 3 : 2)) : u < g || g == u && (4 == w || l || 6 == w && 1 & a[s - 1] || w == (c.s < 0 ? 8 : 7)), s < 1 || !a[0]) e = l ? X(o.charAt(1), -p, o.charAt(0)) : o.charAt(0); else { if (a.length = s, l) for (--n; ++a[--s] > n;)a[s] = 0, s || (++f, a = [1].concat(a)); for (u = a.length; !a[--u];); for (g = 0, e = ""; g <= u; e += o.charAt(a[g++])); e = X(e, f, o.charAt(0)) } return e } }(), v = function () { function S(e, r, n) { var t, i, o, s, f = 0, u = e.length, l = r % F, c = r / F | 0; for (e = e.slice(); u--;)f = ((i = l * (o = e[u] % F) + (t = c * o + (s = e[u] / F | 0) * l) % F * F + f) / n | 0) + (t / F | 0) + c * s, e[u] = i % n; return f && (e = [f].concat(e)), e } function R(e, r, n, t) { var i, o; if (n != t) o = t < n ? 1 : -1; else for (i = o = 0; i < n; i++)if (e[i] != r[i]) { o = e[i] > r[i] ? 1 : -1; break } return o } function _(e, r, n, t) { for (var i = 0; n--;)e[n] -= i, i = e[n] < r[n] ? 1 : 0, e[n] = i * t + e[n] - r[n]; for (; !e[0] && 1 < e.length; e.splice(0, 1)); } return function (e, r, n, t, i) { var o, s, f, u, l, c, a, h, g, p, w, d, m, v, N, O, y, b = e.s == r.s ? 1 : -1, E = e.c, A = r.c; if (!(E && E[0] && A && A[0])) return new B(e.s && r.s && (E ? !A || E[0] != A[0] : A) ? E && 0 == E[0] || !A ? 0 * b : b / 0 : NaN); for (g = (h = new B(b)).c = [], b = n + (s = e.e - r.e) + 1, i || (i = C, s = j(e.e / M) - j(r.e / M), b = b / M | 0), f = 0; A[f] == (E[f] || 0); f++); if (A[f] > (E[f] || 0) && s--, b < 0) g.push(1), u = !0; else { for (v = E.length, O = A.length, b += 2, 1 < (l = U(i / (A[f = 0] + 1))) && (A = S(A, l, i), E = S(E, l, i), O = A.length, v = E.length), m = O, w = (p = E.slice(0, O)).length; w < O; p[w++] = 0); y = A.slice(), y = [0].concat(y), N = A[0], A[1] >= i / 2 && N++; do { if (l = 0, (o = R(A, p, O, w)) < 0) { if (d = p[0], O != w && (d = d * i + (p[1] || 0)), 1 < (l = U(d / N))) for (i <= l && (l = i - 1), a = (c = S(A, l, i)).length, w = p.length; 1 == R(c, p, a, w);)l--, _(c, O < a ? y : A, a, i), a = c.length, o = 1; else 0 == l && (o = l = 1), a = (c = A.slice()).length; if (a < w && (c = [0].concat(c)), _(p, c, w, i), w = p.length, -1 == o) for (; R(A, p, O, w) < 1;)l++, _(p, O < w ? y : A, w, i), w = p.length } else 0 === o && (l++, p = [0]); g[f++] = l, p[0] ? p[w++] = E[m] || 0 : (p = [E[m]], w = 1) } while ((m++ < v || null != p[0]) && b--); u = null != p[0], g[0] || g.splice(0, 1) } if (i == C) { for (f = 1, b = g[0]; 10 <= b; b /= 10, f++); D(h, n + (h.e = f + s * M - 1) + 1, t, u) } else h.e = s, h.r = +u; return h } }(), s = /^(-?)0([xbo])(?=\w[\w.]*$)/i, f = /^([^.]+)\.$/, u = /^\.([^.]+)$/, c = /^-?(Infinity|NaN)$/, g = /^\s*\+(?=[\w.])|^\s+|\s+$/g, h = function (e, r, n, t) { var i, o = n ? r : r.replace(g, ""); if (c.test(o)) e.s = isNaN(o) ? null : o < 0 ? -1 : 1; else { if (!n && (o = o.replace(s, function (e, r, n) { return i = "x" == (n = n.toLowerCase()) ? 16 : "b" == n ? 2 : 8, t && t != i ? e : r }), t && (i = t, o = o.replace(f, "$1").replace(u, "0.$1")), r != o)) return new B(o, i); if (B.DEBUG) throw Error(I + "Not a" + (t ? " base " + t : "") + " number: " + r); e.s = null } e.c = e.e = null }, t.absoluteValue = t.abs = function () { var e = new B(this); return e.s < 0 && (e.s = 1), e }, t.comparedTo = function (e, r) { return z(this, new B(e, r)) }, t.decimalPlaces = t.dp = function (e, r) { var n, t, i; if (null != e) return H(e, 0, q), null == r ? r = O : H(r, 0, 8), D(new B(this), e + this.e + 1, r); if (!(n = this.c)) return null; if (t = ((i = n.length - 1) - j(this.e / M)) * M, i = n[i]) for (; i % 10 == 0; i /= 10, t--); return t < 0 && (t = 0), t }, t.dividedBy = t.div = function (e, r) { return v(this, new B(e, r), N, O) }, t.dividedToIntegerBy = t.idiv = function (e, r) { return v(this, new B(e, r), 0, 1) }, t.exponentiatedBy = t.pow = function (e, r) { var n, t, i, o, s, f, u, l, c = this; if ((e = new B(e)).c && !e.isInteger()) throw Error(I + "Exponent not an integer: " + P(e)); if (null != r && (r = new B(r)), s = 14 < e.e, !c.c || !c.c[0] || 1 == c.c[0] && !c.e && 1 == c.c.length || !e.c || !e.c[0]) return l = new B(Math.pow(+P(c), s ? 2 - V(e) : +P(e))), r ? l.mod(r) : l; if (f = e.s < 0, r) { if (r.c ? !r.c[0] : !r.s) return new B(NaN); (t = !f && c.isInteger() && r.isInteger()) && (c = c.mod(r)) } else { if (9 < e.e && (0 < c.e || c.e < -1 || (0 == c.e ? 1 < c.c[0] || s && 24e7 <= c.c[1] : c.c[0] < 8e13 || s && c.c[0] <= 9999975e7))) return o = c.s < 0 && V(e) ? -0 : 0, -1 < c.e && (o = 1 / o), new B(f ? 1 / o : o); E && (o = L(E / M + 2)) } for (u = s ? (n = new B(.5), f && (e.s = 1), V(e)) : (i = Math.abs(+P(e))) % 2, l = new B(w); ;) { if (u) { if (!(l = l.times(c)).c) break; o ? l.c.length > o && (l.c.length = o) : t && (l = l.mod(r)) } if (i) { if (0 === (i = U(i / 2))) break; u = i % 2 } else if (D(e = e.times(n), e.e + 1, 1), 14 < e.e) u = V(e); else { if (0 == (i = +P(e))) break; u = i % 2 } c = c.times(c), o ? c.c && c.c.length > o && (c.c.length = o) : t && (c = c.mod(r)) } return t ? l : (f && (l = w.div(l)), r ? l.mod(r) : o ? D(l, E, O, void 0) : l) }, t.integerValue = function (e) { var r = new B(this); return null == e ? e = O : H(e, 0, 8), D(r, r.e + 1, e) }, t.isEqualTo = t.eq = function (e, r) { return 0 === z(this, new B(e, r)) }, t.isFinite = function () { return !!this.c }, t.isGreaterThan = t.gt = function (e, r) { return 0 < z(this, new B(e, r)) }, t.isGreaterThanOrEqualTo = t.gte = function (e, r) { return 1 === (r = z(this, new B(e, r))) || 0 === r }, t.isInteger = function () { return !!this.c && j(this.e / M) > this.c.length - 2 }, t.isLessThan = t.lt = function (e, r) { return z(this, new B(e, r)) < 0 }, t.isLessThanOrEqualTo = t.lte = function (e, r) { return -1 === (r = z(this, new B(e, r))) || 0 === r }, t.isNaN = function () { return !this.s }, t.isNegative = function () { return this.s < 0 }, t.isPositive = function () { return 0 < this.s }, t.isZero = function () { return !!this.c && 0 == this.c[0] }, t.minus = function (e, r) { var n, t, i, o, s = this, f = s.s; if (r = (e = new B(e, r)).s, !f || !r) return new B(NaN); if (f != r) return e.s = -r, s.plus(e); var u = s.e / M, l = e.e / M, c = s.c, a = e.c; if (!u || !l) { if (!c || !a) return c ? (e.s = -r, e) : new B(a ? s : NaN); if (!c[0] || !a[0]) return a[0] ? (e.s = -r, e) : new B(c[0] ? s : 3 == O ? -0 : 0) } if (u = j(u), l = j(l), c = c.slice(), f = u - l) { for ((i = (o = f < 0) ? (f = -f, c) : (l = u, a)).reverse(), r = f; r--; i.push(0)); i.reverse() } else for (t = (o = (f = c.length) < (r = a.length)) ? f : r, f = r = 0; r < t; r++)if (c[r] != a[r]) { o = c[r] < a[r]; break } if (o && (i = c, c = a, a = i, e.s = -e.s), 0 < (r = (t = a.length) - (n = c.length))) for (; r--; c[n++] = 0); for (r = C - 1; f < t;) { if (c[--t] < a[t]) { for (n = t; n && !c[--n]; c[n] = r); --c[n], c[t] += C } c[t] -= a[t] } for (; 0 == c[0]; c.splice(0, 1), --l); return c[0] ? _(e, c, l) : (e.s = 3 == O ? -1 : 1, e.c = [e.e = 0], e) }, t.modulo = t.mod = function (e, r) { var n, t, i = this; return e = new B(e, r), !i.c || !e.s || e.c && !e.c[0] ? new B(NaN) : !e.c || i.c && !i.c[0] ? new B(i) : (9 == o ? (t = e.s, e.s = 1, n = v(i, e, 0, 3), e.s = t, n.s *= t) : n = v(i, e, 0, o), (e = i.minus(n.times(e))).c[0] || 1 != o || (e.s = i.s), e) }, t.multipliedBy = t.times = function (e, r) { var n, t, i, o, s, f, u, l, c, a, h, g, p, w, d, m = this, v = m.c, N = (e = new B(e, r)).c; if (!(v && N && v[0] && N[0])) return !m.s || !e.s || v && !v[0] && !N || N && !N[0] && !v ? e.c = e.e = e.s = null : (e.s *= m.s, v && N ? (e.c = [0], e.e = 0) : e.c = e.e = null), e; for (t = j(m.e / M) + j(e.e / M), e.s *= m.s, (u = v.length) < (a = N.length) && (p = v, v = N, N = p, i = u, u = a, a = i), i = u + a, p = []; i--; p.push(0)); for (w = C, d = F, i = a; 0 <= --i;) { for (n = 0, h = N[i] % d, g = N[i] / d | 0, o = i + (s = u); i < o;)n = ((l = h * (l = v[--s] % d) + (f = g * l + (c = v[s] / d | 0) * h) % d * d + p[o] + n) / w | 0) + (f / d | 0) + g * c, p[o--] = l % w; p[o] = n } return n ? ++t : p.splice(0, 1), _(e, p, t) }, t.negated = function () { var e = new B(this); return e.s = -e.s || null, e }, t.plus = function (e, r) { var n, t = this, i = t.s; if (r = (e = new B(e, r)).s, !i || !r) return new B(NaN); if (i != r) return e.s = -r, t.minus(e); var o = t.e / M, s = e.e / M, f = t.c, u = e.c; if (!o || !s) { if (!f || !u) return new B(i / 0); if (!f[0] || !u[0]) return u[0] ? e : new B(f[0] ? t : 0 * i) } if (o = j(o), s = j(s), f = f.slice(), i = o - s) { for ((n = 0 < i ? (s = o, u) : (i = -i, f)).reverse(); i--; n.push(0)); n.reverse() } for ((i = f.length) - (r = u.length) < 0 && (n = u, u = f, f = n, r = i), i = 0; r;)i = (f[--r] = f[r] + u[r] + i) / C | 0, f[r] = C === f[r] ? 0 : f[r] % C; return i && (f = [i].concat(f), ++s), _(e, f, s) }, t.precision = t.sd = function (e, r) { var n, t, i; if (null != e && e !== !!e) return H(e, 1, q), null == r ? r = O : H(r, 0, 8), D(new B(this), e, r); if (!(n = this.c)) return null; if (t = (i = n.length - 1) * M + 1, i = n[i]) { for (; i % 10 == 0; i /= 10, t--); for (i = n[0]; 10 <= i; i /= 10, t++); } return e && this.e + 1 > t && (t = this.e + 1), t }, t.shiftedBy = function (e) { return H(e, -G, G), this.times("1e" + e) }, t.squareRoot = t.sqrt = function () { var e, r, n, t, i, o = this, s = o.c, f = o.s, u = o.e, l = N + 4, c = new B("0.5"); if (1 !== f || !s || !s[0]) return new B(!f || f < 0 && (!s || s[0]) ? NaN : s ? o : 1 / 0); if ((n = 0 == (f = Math.sqrt(+P(o))) || f == 1 / 0 ? (((r = $(s)).length + u) % 2 == 0 && (r += "0"), f = Math.sqrt(+r), u = j((u + 1) / 2) - (u < 0 || u % 2), new B(r = f == 1 / 0 ? "1e" + u : (r = f.toExponential()).slice(0, r.indexOf("e") + 1) + u)) : new B(f + "")).c[0]) for ((f = (u = n.e) + l) < 3 && (f = 0); ;)if (i = n, n = c.times(i.plus(v(o, i, l, 1))), $(i.c).slice(0, f) === (r = $(n.c)).slice(0, f)) { if (n.e < u && --f, "9999" != (r = r.slice(f - 3, f + 1)) && (t || "4999" != r)) { +r && (+r.slice(1) || "5" != r.charAt(0)) || (D(n, n.e + N + 2, 1), e = !n.times(n).eq(o)); break } if (!t && (D(i, i.e + N + 2, 0), i.times(i).eq(o))) { n = i; break } l += 4, f += 4, t = 1 } return D(n, n.e + N + 1, O, e) }, t.toExponential = function (e, r) { return null != e && (H(e, 0, q), e++), i(this, e, r, 1) }, t.toFixed = function (e, r) { return null != e && (H(e, 0, q), e = e + this.e + 1), i(this, e, r) }, t.toFormat = function (e, r, n) { var t; if (null == n) null != e && r && "object" == typeof r ? (n = r, r = null) : e && "object" == typeof e ? (n = e, e = r = null) : n = A; else if ("object" != typeof n) throw Error(I + "Argument not an object: " + n); if (t = this.toFixed(e, r), this.c) { var i, o = t.split("."), s = +n.groupSize, f = +n.secondaryGroupSize, u = n.groupSeparator || "", l = o[0], c = o[1], a = this.s < 0, h = a ? l.slice(1) : l, g = h.length; if (f && (i = s, s = f, g -= f = i), 0 < s && 0 < g) { for (i = g % s || s, l = h.substr(0, i); i < g; i += s)l += u + h.substr(i, s); 0 < f && (l += u + h.slice(i)), a && (l = "-" + l) } t = c ? l + (n.decimalSeparator || "") + ((f = +n.fractionGroupSize) ? c.replace(new RegExp("\\d{" + f + "}\\B", "g"), "$&" + (n.fractionGroupSeparator || "")) : c) : l } return (n.prefix || "") + t + (n.suffix || "") }, t.toFraction = function (e) { var r, n, t, i, o, s, f, u, l, c, a, h, g = this, p = g.c; if (null != e && (!(f = new B(e)).isInteger() && (f.c || 1 !== f.s) || f.lt(w))) throw Error(I + "Argument " + (f.isInteger() ? "out of range: " : "not an integer: ") + P(f)); if (!p) return new B(g); for (r = new B(w), l = n = new B(w), t = u = new B(w), h = $(p), o = r.e = h.length - g.e - 1, r.c[0] = k[(s = o % M) < 0 ? M + s : s], e = !e || 0 < f.comparedTo(r) ? 0 < o ? r : l : f, s = y, y = 1 / 0, f = new B(h), u.c[0] = 0; c = v(f, r, 0, 1), 1 != (i = n.plus(c.times(t))).comparedTo(e);)n = t, t = i, l = u.plus(c.times(i = l)), u = i, r = f.minus(c.times(i = r)), f = i; return i = v(e.minus(n), t, 0, 1), u = u.plus(i.times(l)), n = n.plus(i.times(t)), u.s = l.s = g.s, a = v(l, t, o *= 2, O).minus(g).abs().comparedTo(v(u, n, o, O).minus(g).abs()) < 1 ? [l, t] : [u, n], y = s, a }, t.toNumber = function () { return +P(this) }, t.toPrecision = function (e, r) { return null != e && H(e, 1, q), i(this, e, r, 2) }, t.toString = function (e) { var r, n = this, t = n.s, i = n.e; return null === i ? t ? (r = "Infinity", t < 0 && (r = "-" + r)) : r = "NaN" : (r = null == e ? i <= p || d <= i ? W($(n.c), i) : X($(n.c), i, "0") : 10 === e ? X($((n = D(new B(n), N + i + 1, O)).c), n.e, "0") : (H(e, 2, S.length, "Base"), a(X($(n.c), i, "0"), 10, e, t, !0)), t < 0 && n.c[0] && (r = "-" + r)), r }, t.valueOf = t.toJSON = function () { return P(this) }, t._isBigNumber = !0, null != r && B.set(r), B }()).default = r.BigNumber = r, "function" == typeof define && define.amd ? define(function () { return r }) : "undefined" != typeof module && module.exports ? module.exports = r : (e || (e = "undefined" != typeof self && self ? self : window), e.BigNumber = r) }(this);
	</script>


	<script>
		var Turnout_Count;
		function CS_TO() {
			var x = document.getElementById("TO_SUBPKT");
			const Field_Length = [4, 7, 2, 5, 15, 12, 5, 15, 12, 5, 15, 12];
			var DEC_Text = '';
			var BIN_Text = '';

			DEC_Text += Number(x[0].value);
			BIN_Text += decToBin(Number(x[0].value), Field_Length[0]);
			DEC_Text += Number(x[1].value);
			BIN_Text += decToBin(Number(x[1].value), Field_Length[1]);
			var count = x[2].value;
			Turnout_Count = count;
			for (let i = 3; i < 3 + 3 * count; i++) {
				DEC_Text += Number(x[i].value);
				BIN_Text += decToBin(Number(x[i].value), Field_Length[i]);
			}
			var Pad = '0';
			var Rem = BIN_Text.length % 8;

			if (Rem > 0) {

				for (let i = 0; i < 8 - Rem - 1; i++) {
					Pad += '0';
				}
				BIN_Text = Pad + BIN_Text;
			}

			var BIG_BIN = new BigNumber(BIN_Text, 2);
			var HEX_Text = BIG_BIN.toString(16).padStart(2, '0').toUpperCase();
			var PKT_LENGTH = (BIN_Text.length) / 8;
			x[1].value = PKT_LENGTH - 1;
			DEC_Text = '';
			BIN_Text = '';

			DEC_Text += Number(x[0].value);
			BIN_Text += decToBin(Number(x[0].value), Field_Length[0]);
			DEC_Text += Number(x[1].value);
			BIN_Text += decToBin(Number(x[1].value), Field_Length[1]);

			for (let i = 3; i < 3 + 3 * count; i++) {
				DEC_Text += Number(x[i].value);
				BIN_Text += decToBin(Number(x[i].value), Field_Length[i]);
			}

			Rem = BIN_Text.length % 8;

			if (Rem > 0) {
				Pad = '0';
				for (let i = 0; i < 8 - Rem - 1; i++) {
					Pad += '0';
				}
				BIN_Text = Pad + BIN_Text;
			}


			var BIG2_BIN = new BigNumber(BIN_Text, 2);
			var HEX_Text = BIG2_BIN.toString(16).toUpperCase();
			TURNOUT = HEX_Text;
			TURNOUT_Length = PKT_LENGTH;
			document.getElementById("TO_SPKT").innerHTML =
				"The text in decimal is:" + DEC_Text + "<br>" +
				"The text in binary is:" + BIN_Text + "<br>" +
				"The No. of Bytes are: " + PKT_LENGTH + "<br>" +
				"The Text in Hex is: " + HEX_Text + "<br>" +
				"The Textlength in binary is:" + BIN_Text.length + "<br>" +
				"The Textlength in Hex is: " + HEX_Text.length + "<br>" +
				"The Textlength in bytes is: " + PKT_LENGTH + "<br>" +
				" The remainder is: " + Rem;

			ChangeStatus();
		}




		function maChoiceMenu() {
			var tableMA = document.getElementById("MA_TABLE");
			var tableMARow = tableMA.getElementsByTagName("tr");
			var choice = document.getElementById("AUTH_TYPE2").value;
			var shortenMA = document.getElementById("REQ_SHORTEN_MA2").value;
			var TrainLenInfo = document.getElementById("TRNLEN_INFO_STS2").value;
			var nextStn = document.getElementById("NEXT_STN_COM2").value;

			if (choice == 1) {
				tableMARow[9].style.visibility = "visible";

			}
			else {

				tableMARow[9].style.visibility = "hidden";

			}
			if (shortenMA == 1) {
				tableMARow[13].style.visibility = "visible";

			}
			else {

				tableMARow[13].style.visibility = "hidden";

			}
			if (TrainLenInfo == 1) {
				tableMARow[15].style.visibility = "visible";
				tableMARow[16].style.visibility = "visible";
				tableMARow[17].style.visibility = "visible";

			}
			else {

				tableMARow[15].style.visibility = "hidden";
				tableMARow[16].style.visibility = "hidden";
				tableMARow[17].style.visibility = "hidden";

			}
			if (nextStn == 1) {
				tableMARow[19].style.visibility = "visible";

			}
			else {

				tableMARow[19].style.visibility = "hidden";

			}

			ChangeStatus();
		}

		function turnoutMenu() {
			var table = document.getElementById("SUB_PKT_TYPE_TABLE");
			var row = table.getElementsByTagName("tr");
			var choice = document.getElementById("TO_CNT2");

			for (i = row.length; i > 3; i--) {

				row[3].remove();
			}
			for (i = 0; i < Number(choice.value); i++) {
				var x = document.createElement("tr");

				x.innerHTML = "<td class='tdLabel'><label for='TO_SPEED' class='label'>Turn Out Speed" + (i + 1) + "</label></td><td><select name='TO_SPEED1' id='TO_SPEED" + i + 1 + "' onchange='CS_TO()' style='width:200px'><option value='6'>Upto 30 Kmph</option><option value='3'>Upto 15 Kmph</option><option value='1'>Upto 5 Kmph</option><option value='2'>Upto 10 Kmph</option>						<option value='4'>Upto 20 Kmph</option>						<option value='5'>Upto 25 Kmph</option>						<option value='7'>Upto 35 Kmph</option>						<option value='8'>Upto 40 Kmph</option>						<option value='9'>Upto 45 Kmph</option>						<option value='10'>Upto 50 Kmph</option>						<option value='11'>Upto 55 Kmph</option>						<option value='12'>Upto 60 Kmph</option>						<option value='13'>Upto 65 Kmph</option>						<option value='14'>Upto 70 KmphS</option>						<option value='15'>Upto 75 Kmph</option>						<option value='16'>Upto 80 Kmph</option>						<option value='17'>Upto 85 Kmph</option>						<option value='18'>Upto 90 Kmph</option>						<option value='31'>Unrestricted</option>					</select>				</td>				<td id='DIFF_DIST_TO'>				<td class='tdLabel'><label for='DIFF_DIST_TO' class='label'>Distance Of Turnout From Last Ref RFID					</label></td>				<td><input type='number' step='any' name='DIFF_DIST_TO" + i + 1 + "' min='0' max='32760' value='19000'						id='DIFF_DIST_TO" + i + 1 + "' onchange='CS_TO()' style='width:200px' /></td>				</td>				<td id='TO_SPEED_REL_DIST'>				<td class='tdLabel'><label for='TO_SPEED_REL_DIST' class='label'>Turnout Release Distance</label></td>				<td><input type='number' name='TO_SPEED_REL_DIST" + i + 1 + "' min='0' max='4095' value='19' id='TO_SPEED_REL_DIST" + i + 1 + "'						onchange='CS_TO()' style='width:200px' /></td>				</td>"

				table.appendChild(x);
			}

			ChangeStatus();
		}

		function trackConditionMenu() {
			var table = document.getElementById("TCD_TABLE");
			var row = table.getElementsByTagName("tr");
			var choice = document.getElementById("TC_CNT2");

			for (i = row.length; i > 3; i--) {

				row[3].remove();
			}
			for (i = 0; i < Number(choice.value); i++) {
				var x = document.createElement("tr");


				x.innerHTML = "<td class='tdLabel'><label for='TC_TYPE' class='label'>Track Condition type" + (i + 1) + "</label></td>				<td><select name='TC_TYPE" + (i + 1) + "' id='TC_TYPE" + (i + 1) + "' onchange='CS_TCD()' style='width:200px'>						<option value='5'>Powerless Section</option>						<option value='0'>Not Used</option>						<option value='1'>Dead Stop</option>						<option value='2'>Radio Hole</option>						<option value='3'>Non Stopping Area</option>						<option value='4'>Tunnel Stopping Area</option>						<option value='6'>Sound Horn</option>						<option value='7'>Reversing Area</option>	<option value='8'>Fouling Mark Location</option>				</select>				</td>				<td id='START_DIST_TC'>				<td class='tdLabel'><label for='START_DIST_TC' class='label'>Start distance </label></td>				<td><input type='number' name='START_DIST_TC" + (i + 1) + "' min='1' max='32768' value='431' id='START_DIST_TC" + (i + 1) + "'						onchange='CS_TCD()' style='width:200px' /></td>				</td>				<td id='LENGTH_TC'>				<td class='tdLabel'><label for='LENGTH_TC' class='label'>Length of track condition</label></td>				<td><input type='number' name='LENGTH_TC' min='1' max='32768' value='31' id='LENGTH_TC'						onchange='CS_TCD()' style='width:200px' /></td>				</td>";

				table.appendChild(x);
			}
			ChangeStatus();
		}




		function speedInfoMenu() {
			var table = document.getElementById("SPEED_INFO_TABLE");
			var row = table.getElementsByTagName("tr");
			var choice = document.getElementById("LM_SPEED_INFO_CNT2");

			for (i = row.length; i > 3; i--) {

				row[3].remove();
			}
			for (i = 0; i < Number(choice.value); i++) {
				var x = document.createElement("tr");


				x.innerHTML = "<td class='tdLabel'><label for='LM_STATIC_SPEED_DIST' class='label'>Static Speed Distance" + (i + 1) + " </label></td>				<td><input type='number' step='any' name='LM_STATIC_SPEED_DIST" + (i + 1) + "' min='0' max='32768' value='1900'						id='LM_STATIC_SPEED_DIST" + (i + 1) + "' onchange='CS_SSP()' style='width:200px' /></td>				</td><td class='tdLabel'><label for='LM_STATIC_SPEED_TYPE' class='label'>Static Speed Type</label></td>				<td><select name='LM_STATIC_SPEED_TYPE" + (i + 1) + "' id='LM_STATIC_SPEED_TYPE" + (i + 1) + "' onchange='CS_SSP()'						style='width:200px'>						<option value='0'>Universal Static Speed</option>						<option value='1'>Classified Speeds A,B,C will follow</option>						</td>				<td class='tdLabel'><label for='LM_STATIC_SPEED_VALUE' class='label'>Static Speed value</label></td>				<td><input type='number' name='LM_STATIC_SPEED_VALUE" + (i + 1) + "' min='1' max='50' value='19'						id='LM_STATIC_SPEED_VALUE" + (i + 1) + "' onchange='CS_SSP()' style='width:200px' /></td>";

				table.appendChild(x);
			}
			ChangeStatus();
		}




		function tagLinkingMenu() {
			var table = document.getElementById("TAG_LINKING_TABLE");
			var row = table.getElementsByTagName("tr");
			var choice = document.getElementById("ROUTE_RFID_CNT2");

			for (i = row.length; i > 4; i--) {

				row[4].remove();
			}
			for (i = 0; i < Number(choice.value); i++) {
				var x = document.createElement("tr");

				x.innerHTML = "<td class='tdLabel'><label for='DIST_NXT_RFID' class='label'>Distance of next RFID tag </label></td>				<td><input type='number' name='DIST_NXT_RFID" + (i + 1) + "' min='1' max='1023' value='761' id='DIST_NXT_RFID" + (i + 1) + "'						onchange='CS_TLI()' style='width:200px' /></td>				<td class='tdLabel'><label for='NXT_RFID_TAG_ID' class='label'>Next RFID tag ID </label></td>				<td><input type='number' name='NXT_RFID_TAG_ID" + (i + 1) + "' min='1' max='1023' value='999' id='NXT_RFID_TAG_ID" + (i + 1) + "'						onchange='CS_TLI()' style='width:200px' /></td>		<td class='tdLabel'><label for='DUP_TAG_DIR' class='label'>Duplicate Tag Direction w.r.t Main Tag</label></td><td><select name='DUP_TAG_DIR" + (i + 1) + "' id='DUP_TAG_DIR" + (i + 1) + "' onchange='CS_SSP()'						style='width:200px'>						<option value='0'>Duplicate Tag in Nominal Direction(+)</option>						<option value='1'>Duplicate Tag in Reverse Direction(-)</option>						</td>";

				table.appendChild(x);
			}

			var table2 = document.createElement("table");

			table2.innerHTML = "<tr id='ABS_LOC_RESET2'>				<td class='tdLabel'><label for='ABS_LOC_RESET' class='label'>Absolute Location Reset </label></td>				<td><select name='ABS_LOC_RESET' id='ABS_LOC_RESET' onchange='absLocResetMenu();CS_TLI()' style='width:200px'>													<option value='1'>Location Correction(New Section) </option>		<option value='0'>No Locational Error</option>								</select>				</td>			</tr>			<tr id='START_DIST_TO_LOC_RESET'>				<td class='tdLabel'><label for='START_DIST_TO_LOC_RESET' class='label'>Start Distance of Normal Tag				</label></td>				<td><input type='number' name='START_DIST_TO_LOC_RESET' min='1' max='32768' value='19'						id='START_DIST_TO_LOC_RESET' onchange='CS_TLI()' style='width:200px' /></td>			</tr>			<tr id='ADJ_LOCO_DIR'>				<td class='tdLabel'><label for='ADJ_LOCO_DIR' class='label'>Adjacent loco direction </label></td>				<td><select name='ADJ_LOCO_DIR' id='ADJ_LOCO_DIR' onchange='CS_TLI()' style='width:200px'>						<option value='0'>Not known</option>						<option value='1'>Nominal</option>						<option value='2'>Reverse</option>						<option value='3'>Deduce from tags</option>					</select>				</td>			</tr>			<tr id='ABS_LOC_CORRECTION'>				<td class='tdLabel'><label for='ABS_LOC_CORRECTION' class='label'>New Absolute Location</label></td>				<td><input type='number' name='ABS_LOC_CORRECTION' min='1' max='8388608' value='19'						id='ABS_LOC_CORRECTION' onchange='CS_TLI()' style='width:200px' /></td>			</tr>			<tr id='ADJ_LINE_CNT'>				<td class='tdLabel'><label for='ADJ_LINE_CNT' class='label'>Adjacent line count</label></td>				<td><select name='ADJ_LINE_CNT' id='ADJ_LINE_CNT2' onchange='adjacentLineMenu();CS_TLI()' style='width:200px'>						<option value='0'>No adjacent lines, Self TIN will follow</option>						<option value='1'>1 adjacent line, excluding occupied self TIN</option>						<option value='2'>2 adjacent lines, excluding occupied self TIN</option>						<option value='3'>3 adjacent lines, excluding occupied self TIN</option>						<option value='4'>4 adjacent lines, excluding occupied self TIN</option>						<option value='5'>5 adjacent lines, excluding occupied self TIN</option>						<option value='6'>6 adjacent lines, excluding occupied self TIN</option>					</select>				</td>			</tr>			<tr id='LINE_TIN1'>				<td class='tdLabel'><label for='LINE_TIN' class='label'>Self TIN </label></td>				<td><input type='number' name='LINE_TIN1' min='1' max='512' value='251' id='LINE_TIN1'						onchange='CS_TLI()' style='width:200px' /></td>			</tr>";
			document.getElementById("TAG_LINKING_TABLE").appendChild(table2.firstChild);

			ChangeStatus();
		}

		function absLocResetMenu() {
			var table = document.getElementById("TAG_LINKING_TABLE");
			var row = table.getElementsByTagName("tr");
			var rowCount = row.length;
			var resetChoice = document.getElementById("ABS_LOC_RESET");
			var rfidCount = document.getElementById("ROUTE_RFID_CNT2");
			

			for (i = row.length; i > 5+Number(ROUTE_RFID_CNT2.value); i--) {
				
				row[5+Number(ROUTE_RFID_CNT2.value)].remove();
			}
			
				
			if(Number(resetChoice.value)==0){
				{
				var x = document.createElement("tr");
				x.innerHTML ="<td class='tdLabel'><label for='ADJ_LINE_CNT' class='label'>Adjacent line count</label></td>				<td><select name='ADJ_LINE_CNT' id='ADJ_LINE_CNT2' onchange='adjacentLineMenu();CS_TLI()' style='width:200px'>						<option value='0'>No adjacent lines, Self TIN will follow</option>						<option value='1'>1 adjacent line, excluding occupied self TIN</option>						<option value='2'>2 adjacent lines, excluding occupied self TIN</option>						<option value='3'>3 adjacent lines, excluding occupied self TIN</option>						<option value='4'>4 adjacent lines, excluding occupied self TIN</option>						<option value='5'>5 adjacent lines, excluding occupied self TIN</option>						<option value='6'>6 adjacent lines, excluding occupied self TIN</option>					</select>				</td>			";
				table.appendChild(x);
				}
				{
				var x = document.createElement("tr");
				x.innerHTML="<td class='tdLabel'><label for='LINE_TIN' class='label'>Self TIN </label></td>				<td><input type='number' name='LINE_TIN1' min='1' max='512' value='251' id='LINE_TIN1'						onchange='CS_TLI()' style='width:200px' /></td>";
				table.appendChild(x);
				}
			}
			else{
				
				
				{
				var x = document.createElement("tr");
				x.innerHTML="<td class='tdLabel'><label for='START_DIST_TO_LOC_RESET' class='label'>Start Distance of Normal Tag				</label></td>				<td><input type='number' name='START_DIST_TO_LOC_RESET' min='1' max='32768' value='19'						id='START_DIST_TO_LOC_RESET' onchange='CS_TLI()' style='width:200px' /></td>";
				table.appendChild(x);
				}
				
				{
				var x = document.createElement("tr");
				x.innerHTML="<td class='tdLabel'><label for='ADJ_LOCO_DIR' class='label'>Adjacent loco direction </label></td>				<td><select name='ADJ_LOCO_DIR' id='ADJ_LOCO_DIR' onchange='CS_TLI()' style='width:200px'>						<option value='0'>Not known</option>						<option value='1'>Nominal</option>						<option value='2'>Reverse</option>						<option value='3'>Deduce from tags</option>					</select>				</td>";
				table.appendChild(x);
				}
				
				{
				var x = document.createElement("tr");
				x.innerHTML="<td class='tdLabel'><label for='ABS_LOC_CORRECTION' class='label'>New Absolute Location</label></td>				<td><input type='number' name='ABS_LOC_CORRECTION' min='1' max='8388608' value='19'						id='ABS_LOC_CORRECTION' onchange='CS_TLI()' style='width:200px' /></td>";
				table.appendChild(x);
				}
				
				
				{
				var x = document.createElement("tr");
				x.innerHTML ="<td class='tdLabel'><label for='ADJ_LINE_CNT' class='label'>Adjacent line count</label></td>				<td><select name='ADJ_LINE_CNT' id='ADJ_LINE_CNT2' onchange='adjacentLineMenu();CS_TLI()' style='width:200px'>						<option value='0'>No adjacent lines, Self TIN will follow</option>						<option value='1'>1 adjacent line, excluding occupied self TIN</option>						<option value='2'>2 adjacent lines, excluding occupied self TIN</option>						<option value='3'>3 adjacent lines, excluding occupied self TIN</option>						<option value='4'>4 adjacent lines, excluding occupied self TIN</option>						<option value='5'>5 adjacent lines, excluding occupied self TIN</option>						<option value='6'>6 adjacent lines, excluding occupied self TIN</option>					</select>				</td>			";
				table.appendChild(x);
				}
				{
				var x = document.createElement("tr");
				x.innerHTML="<td class='tdLabel'><label for='LINE_TIN' class='label'>Self TIN </label></td>				<td><input type='number' name='LINE_TIN1' min='1' max='512' value='251' id='LINE_TIN1'						onchange='CS_TLI()' style='width:200px' /></td>";
				table.appendChild(x);
				}
			}
			table.appendChild(x);
				//x.innerHTML = "<td class='tdLabel'><label for='DIST_NXT_RFID' class='label'>Distance of next RFID tag </label></td>				<td><input type='number' name='DIST_NXT_RFID" + (i + 1) + "' min='1' max='1023' value='761' id='DIST_NXT_RFID" + (i + 1) + "'						onchange='CS_TLI()' style='width:200px' /></td>				<td class='tdLabel'><label for='NXT_RFID_TAG_ID' class='label'>Next RFID tag ID </label></td>				<td><input type='number' name='NXT_RFID_TAG_ID" + (i + 1) + "' min='1' max='1023' value='999' id='NXT_RFID_TAG_ID" + (i + 1) + "'						onchange='CS_TLI()' style='width:200px' /></td>		<td class='tdLabel'><label for='DUP_TAG_DIR' class='label'>Duplicate Tag Direction w.r.t Main Tag</label></td><td><select name='DUP_TAG_DIR" + (i + 1) + "' id='DUP_TAG_DIR" + (i + 1) + "' onchange='CS_SSP()'						style='width:200px'>						<option value='0'>Duplicate Tag in Nominal Direction(+)</option>						<option value='1'>Duplicate Tag in Reverse Direction(-)</option>						</td>";

				//table.appendChild(x);
			


		}



		function adjacentLineMenu() {
			var table = document.getElementById("TAG_LINKING_TABLE");
			var row = table.getElementsByTagName("tr");
			var rowCount = row.length;
			var choice = document.getElementById("ADJ_LINE_CNT2");
			var rfidCount = document.getElementById("ROUTE_RFID_CNT2");
			var resetChoice = document.getElementById("ABS_LOC_RESET");

			var temp = 10 + rfidCount.value + 1;
			for (i = 0; i < (rowCount - 7 - Number(rfidCount.value)-Number(resetChoice.value)*3); i++) {

				row[(rowCount - 1 - i)].remove();
			}

			for (i = 0; i < Number(choice.value); i++) {
				var x = document.createElement("tr");

				x.innerHTML = "<td class='tdLabel'><label for='LINE_TIN' class='label'>Adjacent Line TIN </label></td>				<td><input type='number' name='LINE_TIN" + (i + 1) + "' min='1' max='512' value='412' id='LINE_TIN1'						onchange='CS_TLI()' style='width:200px' /></td>"

				table.appendChild(x);
			}

			ChangeStatus();
		}



		function gradientMenu() {
			var table = document.getElementById("GRADIENT_TABLE");
			var row = table.getElementsByTagName("tr");
			var choice = document.getElementById("GRAD_CNT2");

			for (i = row.length; i > 3; i--) {

				row[3].remove();
			}
			for (i = 0; i < Number(choice.value); i++) {
				var x = document.createElement("tr");


				x.innerHTML = "<td class='tdLabel'><label for='GRAD_DISTANCE' class='label'>Gradient Distance " + (i + 1) + "(in meter) </label></td>				<td><input type='number' name='GRAD_DISTANCE" + (i + 1) + "' min='0' max='32760' value='500' id='GRAD_DISTANCE" + (i + 1) + "'						onchange='CS_GRAD()' style='width:200px' /></td>				</td>				<td class='tdLabel'><label for='GRAD_DIR' class='label'>Gradient Type</label></td>				<td><select name='GRAD_DIR" + (i + 1) + "' id='GRAD_DIR" + (i + 1) + "' onchange='CS_GRAD()' style='width:200px'>						<option value='0'>Downhill</option>						<option value='1'>Uphill</option>					</select>				</td>				<td class='tdLabel'><label for='GRAD_VALUE' class='label'>Gradient Value(in meter)</label></td>				<td><select name='GRAD_VALUE' id='GRAD_VALUE" + (i + 1) + "' onchange='CS_GRAD()' style='width:200px'>					<option value='0'>Gradient not steeper than 1 in 1000. Includes Level Gradient</option>					<option value='1'>Gradient from 1 in 1000 to not steeper than 1 in 500</option>					<option value='2'>Gradient from 1 in 500 to not steeper than 1 in 333</option>					<option value='3'>Gradient from 1 in 333 to not steeper than 1 in 250</option>					<option value='4'>Gradient from 1 in 250 to not steeper than 1 in 200</option>					<option value='5'>Gradient from 1 in 200 to not steeper than 1 in 166</option>					<option value='6'>Gradient from 1 in 166 to not steeper than 1 in 142</option>					<option value='7'>Gradient from 1 in 142 to not steeper than 1 in 125</option>					<option value='8'>Gradient from 1 in 125 to not steeper than 1 in 111</option>					<option value='9'>Gradient from 1 in 111 to not steeper than 1 in 100</option>					<option value='10'>Gradient from 1 in 100 to not steeper than 1 in 90</option>					<option value='11'>Gradient from 1 in 90 to not steeper than 1 in 83</option>					<option value='12'>Gradient from 1 in 83 to not steeper than 1 in 76</option>					<option value='13'>Gradient from 1 in 76 to not steeper than 1 in 71</option>					<option value='14'>Gradient from 1 in 71 to not steeper than 1 in 66</option>					<option value='15'>Gradient from 1 in 66 to not steeper than 1 in 62</option>					<option value='16'>Gradient from 1 in 62 to not steeper than 1 in 58</option>					<option value='17'>Gradient from 1 in 58 to not steeper than 1 in 55</option>					<option value='18'>Gradient from 1 in 55 to not steeper than 1 in 52</option>					<option value='19'>Gradient from 1 in 52 to not steeper than 1 in 50</option>					<option value='20'>Gradient from 1 in 50 to not steeper than 1 in 47</option>					<option value='21'>Gradient from 1 in 47 to not steeper than 1 in 45</option>					<option value='22'>Gradient from 1 in 45 to not steeper than 1 in 43</option>					<option value='23'>Gradient from 1 in 43 to not steeper than 1 in 41</option>					<option value='24'>Gradient from 1 in 41 to not steeper than 1 in 40</option>					<option value='25'>Gradient from 1 in 40 to not steeper than 1 in 38</option>					<option value='26'>Gradient from 1 in 38 to not steeper than 1 in 37</option>					<option value='27'>Gradient from 1 in 37 to not steeper than 1 in 35</option>					<option value='28'>Gradient from 1 in 35 to not steeper than 1 in 34</option>					<option value='29'>Gradient steeper than 1 in 33</option>					</select>				</td>";

				table.appendChild(x);
			}
			ChangeStatus();
		}



		function LCgateMenu() {
			var table = document.getElementById("LC_TABLE");
			var row = table.getElementsByTagName("tr");
			var choice = document.getElementById("LC_CNT2");

			for (i = row.length; i > 3; i--) {

				row[3].remove();
			}
			for (i = 0; i < Number(choice.value); i++) {
				var x = document.createElement("tr");
				var y = document.createElement("tr");


				x.innerHTML = "<td class='tdLabel'><label for='LC_DISTANCE' class='label'>LC Gate " + (i + 1) + " Distance(in meter) </label></td>				<td><input type='number' name='LC_DISTANCE" + (i + 1) + "' min='0' max='32760' value='500' id='GRAD_DISTANCE" + (i + 1) + "'						onchange='CS_LC()' style='width:200px' /></td>				</td>				<td class='tdLabel'><label for='LC_ID' class='label'>LC Gate ID </label></td>				<td><input type='number' name='LC_ID" + (i + 1) + "' min='0' max='32760' value='500' id='LC_ID" + (i + 1) + "'						onchange='CS_LC()' style='width:200px' /></td>				</td>				<td class='tdLabel'><label for='LC_ALPHA' class='label'>LC Gate ID(Alpha)</label></td>				<td><select name='LC_ALPHA" + (i + 1) + "' id='LC_ALPHA" + (i + 1) + "' onchange='CS_LC()' style='width:200px'>						<option value='0'>No suffix</option>						<option value='1'>a</option>						<option value='2'>b</option>						<option value='3'>c</option>						<option value='4'>d</option>						<option value='5'>e</option>						<option value='6'>Out of Range</option>					</select>				</td>";

				table.appendChild(x);
				y.innerHTML = "<td class='tdLabel'><label for='LC_TYPE' class='label'>LC Gate" + (i + 1) + " Type</label></td>				<td><select name='LC_TYPE" + (i + 1) + "' id='LC_TYPE" + (i + 1) + "' onchange='CS_LC()' style='width:200px'>						<option value='0'>Manned</option>						<option value='1'>Unmanned</option>					</select>				</td>				<td class='tdLabel'><label for='LC_CLASS' class='label'>LC Gate " + (i + 1) + " Class</label></td>				<td><select name='LC_CLASS" + (i + 1) + "' id='LC_CLASS" + (i + 1) + "' onchange='CS_LC()' style='width:200px'>						<option value='0'>Spacial</option>						<option value='1'>A</option>						<option value='2'>B1</option>						<option value='3'>B2</option>						<option value='4'>B</option>						<option value='5'>C</option>						<option value='6'>D</option>					</select>				</td>				<td class='tdLabel'><label for='LC_WHIST_EN' class='label'>Auto Whistling Enable </label></td>				<td><select name='LC_WHIST_EN" + (i + 1) + "' id='LC_WHIST_EN" + (i + 1) + "' onchange='CS_LC()' style='width:200px'>					<option value='0'>No</option>					<option value='1'>Yes</option>				</select>				</td>				<td class='tdLabel'><label for='LC_WHIST_Type' class='label'>Auto Whistling Type </label></td>				<td><select name='LC_WHIST_Type" + (i + 1) + "' id='LC_WHIST_Type" + (i + 1) + "' onchange='CS_LC()' style='width:200px'>					<option value='0'>Distance Based</option>					<option value='1'>Time Based</option>					<option value='2'>Configuration Pattern Based</option>				</select>				</td>";
				table.appendChild(y);
			}
			ChangeStatus();
		}

		function TSRMenu() {
			var table = document.getElementById("TSR_TABLE");
			var row = table.getElementsByTagName("tr");
			var choice = document.getElementById("TSR_CNT2");

			for (i = row.length; i > 4; i--) {

				row[4].remove();
			}
			for (i = 0; i < Number(choice.value); i++) {
				var x = document.createElement("tr");
				var y = document.createElement("tr");

				x.innerHTML = "<td class='tdLabel'><label for='TSR_ID" + (i + 1) + "' class='label'>TSR " + (i + 1) + " ID</label></td>                <td><input type='number' name='TSR_ID" + (i + 1) + "' min='1' max='255' value='111'  onchange='CS_TSR()' style='width:200px' /></td>                <td class='tdLabel'><label for='TSR_Distance" + (i + 1) + "' class='label'>TSR Distance</label></td>                <td><input type='number' name='TSR_Distance" + (i + 1) + "' min='0' max='32760' value='300'  onchange='CS_TSR()' style='width:200px' /></td>                <td class='tdLabel'><label for='TSR_Length" + (i + 1) + "' class='label'>TSR Length</label></td>                <td><input type='number' name='TSR_Length" + (i + 1) + "' min='0' max='32760' value='301'  onchange='CS_TSR()' style='width:200px' /></td>";

				table.appendChild(x);
				y.innerHTML = "<td class='tdLabel'><label for='TSR_Class" + (i + 1) + "' class='label'>TSR " + (i + 1) + " Class</label>                </td>                <td><select name='TSR_Class" + (i + 1) + "' id='TSR_Class" + (i + 1) + "' onchange='CS_TSR()' style='width:200px'>                        <option value='0'>Universal Speed</option>							<option value='1'>Classified Speed</option>                    </select>                </td>                 <td class='tdLabel'><label for='TSR_Universal_Speed" + (i + 1) + "' class='label'>TSR Universal Speed</label></td>                <td><input type='number' name='TSR_Universal_Speed" + (i + 1) + "' min='0' max='40' value='5'  onchange='CS_TSR()' style='width:200px' /></td>                <td class='tdLabel'><label for='TSR_Whistle" + (i + 1) + "' class='label'>TSR Whistle</label>                </td>                <td><select name='TSR_Whistle" + (i + 1) + "' id='TSR_Whistle" + (i + 1) + "' onchange='CS_TSR()' style='width:200px'>                        <option value='0'>No Whistle</option>						<option value='1'>Whistle blow</option>";
				table.appendChild(y);
			}
			ChangeStatus();
		}

		function CS_TSR() {
			var x = document.getElementById("TSR_SUBPKT");
			const Field_Length = [4, 7, 2, 5];
			var DEC_Text = "The text in decimal is:";
			var BIN_Text = "";
			var TSR_Info_CNT = Number(x[3].value);
			var k = 0;
			var k1 = '';
			if (TSR_Info_CNT > 0) {
				for (var j = TSR_Info_CNT; j >= 1; j--) {
					k = 3 + 6 * (j);
					k1 += k + '-';
					DEC_Text += Number(x[k].value);

					BIN_Text += decToBin(Number(x[k].value), 2);
					DEC_Text += Number(x[k - 1].value);
					BIN_Text += decToBin(Number(x[k - 1].value), 6);
					DEC_Text += Number(x[k - 2].value);
					BIN_Text += decToBin(Number(x[k - 2].value), 1);
					DEC_Text += Number(x[k - 3].value);
					BIN_Text += decToBin(Number(x[k - 3].value), 15);
					DEC_Text += Number(x[k - 4].value);
					BIN_Text += decToBin(Number(x[k - 4].value), 15);
					DEC_Text += Number(x[k - 5].value);
					BIN_Text += decToBin(Number(x[k - 5].value), 8);

				}
			}
			for (var i = 3; i >= 0; i--) {
				DEC_Text += Number(x[i].value);
				BIN_Text += decToBin(Number(x[i].value), Field_Length[i]);
			}
			var Rem = 0;
			Rem = BIN_Text.length % 8;

			if (Rem > 0) {
				var Pad = "0";
				for (i = 0; i < 8 - Rem - 1; i++)
					Pad += "0";
				BIN_Text = Pad + BIN_Text;
			}


			var BIG_BIN = new BigNumber(BIN_Text, 2);
			var HEX_Text = BIG_BIN.toString(16).toUpperCase();
			var PKT_LENGTH = Number(BIN_Text.length) / 8;
			x[1].value = PKT_LENGTH;
			TSR_LENGTH = PKT_LENGTH;
			BIN_Text = "";
			DEC_Text = "The text in decimal is:";

			k = 0;
			k1 = '';
			if (TSR_Info_CNT > 0) {
				for (var j = TSR_Info_CNT; j >= 1; j--) {
					k = 3 + 6 * (j);
					k1 += k + '-';
					DEC_Text += Number(x[k].value);

					BIN_Text += decToBin(Number(x[k].value), 2);
					DEC_Text += Number(x[k - 1].value);
					BIN_Text += decToBin(Number(x[k - 1].value), 6);
					DEC_Text += Number(x[k - 2].value);
					BIN_Text += decToBin(Number(x[k - 2].value), 1);
					DEC_Text += Number(x[k - 3].value);
					BIN_Text += decToBin(Number(x[k - 3].value), 15);
					DEC_Text += Number(x[k - 4].value);
					BIN_Text += decToBin(Number(x[k - 4].value), 15);
					DEC_Text += Number(x[k - 5].value);
					BIN_Text += decToBin(Number(x[k - 5].value), 8);
				}
			}

			for (let i = 3; i >= 0; i--) {
				DEC_Text += Number(x[i].value);
				BIN_Text += decToBin(Number(x[i].value), Field_Length[i]);
			}

			var Rem1 = 0;
			Rem1 = BIN_Text.length % 8;

			if (Rem1 > 0) {
				Pad = "0";
				for (i = 0; i < 8 - Rem1 - 1; i++)
					Pad += "0";
				BIN_Text = Pad + BIN_Text;
			}


			var BIG_BIN2 = new BigNumber(BIN_Text, 2);
			HEX_Text = BIG_BIN2.toString(16).toUpperCase();
			TSR = HEX_Text;
			document.getElementById("TSR_SPKT").innerHTML = DEC_Text + "<br>" +
				"The text in binary is:" + BIN_Text + "<br>" +
				"The Hex Equivalent is: " + HEX_Text + "<br>" +
				"The Packet Length in bytes is:" + PKT_LENGTH + "<br>"
			ChangeStatus();
		}



		function CS_LC() {
			var x = document.getElementById("LC_SUBPKT");
			const Field_Length = [4, 7, 5];
			var DEC_Text = "The text in decimal is:";
			var BIN_Text = "";
			var LC_Info_CNT = Number(x[2].value);
			var k = 0;
			var k1 = '';
			if (LC_Info_CNT > 0) {
				for (var j = LC_Info_CNT; j >= 1; j--) {
					k = 2 + 7 * (j);
					k1 += k + '-';
					DEC_Text += Number(x[k].value);

					BIN_Text += decToBin(Number(x[k].value), 2);
					DEC_Text += Number(x[k - 1].value);
					BIN_Text += decToBin(Number(x[k - 1].value), 1);
					DEC_Text += Number(x[k - 2].value);
					BIN_Text += decToBin(Number(x[k - 2].value), 3);
					DEC_Text += Number(x[k - 3].value);
					BIN_Text += decToBin(Number(x[k - 3].value), 1);
					DEC_Text += Number(x[k - 4].value);
					BIN_Text += decToBin(Number(x[k - 4].value), 3);
					DEC_Text += Number(x[k - 5].value);
					BIN_Text += decToBin(Number(x[k - 5].value), 10);
					DEC_Text += Number(x[k - 6].value);
					BIN_Text += decToBin(Number(x[k - 6].value), 15);
				}
			}
			for (var i = 2; i >= 0; i--) {
				DEC_Text += Number(x[i].value);
				BIN_Text += decToBin(Number(x[i].value), Field_Length[i]);
			}
			var Rem = 0;
			Rem = BIN_Text.length % 8;

			if (Rem > 0) {
				var Pad = "0";
				for (i = 0; i < 8 - Rem - 1; i++)
					Pad += "0";
				BIN_Text = Pad + BIN_Text;
			}


			var BIG_BIN = new BigNumber(BIN_Text, 2);
			var HEX_Text = BIG_BIN.toString(16).toUpperCase();
			var PKT_LENGTH = Number(BIN_Text.length) / 8;
			x[1].value = PKT_LENGTH;
			LC_LENGTH = PKT_LENGTH;
			BIN_Text = "";
			DEC_Text = "The text in decimal is:";

			k = 0;
			k1 = '';
			if (LC_Info_CNT > 0) {
				for (var j = LC_Info_CNT; j >= 1; j--) {
					k = 2 + 7 * (j);
					k1 += k + '-';

					DEC_Text += Number(x[k].value);
					BIN_Text += decToBin(Number(x[k].value), 2);
					DEC_Text += Number(x[k - 1].value);
					BIN_Text += decToBin(Number(x[k - 1].value), 1);
					DEC_Text += Number(x[k - 2].value);
					BIN_Text += decToBin(Number(x[k - 2].value), 3);
					DEC_Text += Number(x[k - 3].value);
					BIN_Text += decToBin(Number(x[k - 3].value), 1);
					DEC_Text += Number(x[k - 4].value);
					BIN_Text += decToBin(Number(x[k - 4].value), 3);
					DEC_Text += Number(x[k - 5].value);
					BIN_Text += decToBin(Number(x[k - 5].value), 10);
					DEC_Text += Number(x[k - 6].value);
					BIN_Text += decToBin(Number(x[k - 6].value), 15);
				}
			}
			for (let i = 2; i >= 0; i--) {
				DEC_Text += Number(x[i].value);
				BIN_Text += decToBin(Number(x[i].value), Field_Length[i]);
			}

			var Rem1 = 0;
			Rem1 = BIN_Text.length % 8;

			if (Rem1 > 0) {
				Pad = "0";
				for (i = 0; i < 8 - Rem1 - 1; i++)
					Pad += "0";
				BIN_Text = Pad + BIN_Text;
			}


			var BIG_BIN2 = new BigNumber(BIN_Text, 2);
			HEX_Text = BIG_BIN2.toString(16).toUpperCase();
			LC = HEX_Text;
			document.getElementById("LC_SPKT").innerHTML = DEC_Text + "<br>" +
				"The text in binary is:" + BIN_Text + "<br>" +
				"The Hex Equivalent is: " + HEX_Text + "<br>" +
				"The Packet Length in bytes is:" + PKT_LENGTH + "<br>"
			ChangeStatus();
		}


		function CS_GRAD() {
			var x = document.getElementById("GRAD_SUBPKT");
			const Field_Length = [4, 7, 5];
			var DEC_Text = "The text in decimal is:";
			var BIN_Text = "";
			var Grad_Info_CNT = Number(x[2].value);
			var k = 0;
			var k1 = '';
			if (Grad_Info_CNT > 0) {
				for (var j = Grad_Info_CNT; j >= 1; j--) {
					k = 2 + 3 * (j);
					k1 += k + '-';
					DEC_Text += Number(x[k].value);
					BIN_Text += decToBin(Number(x[k].value), 5);
					DEC_Text += Number(x[k - 1].value);
					BIN_Text += decToBin(Number(x[k - 1].value), 1);
					DEC_Text += Number(x[k - 2].value);
					BIN_Text += decToBin(Number(x[k - 2].value), 15);
				}
			}
			for (var i = 2; i >= 0; i--) {
				DEC_Text += Number(x[i].value);
				BIN_Text += decToBin(Number(x[i].value), Field_Length[i]);
			}
			var Rem = 0;
			Rem = BIN_Text.length % 8;

			if (Rem > 0) {
				var Pad = "0";
				for (i = 0; i < 8 - Rem - 1; i++)
					Pad += "0";
				BIN_Text = Pad + BIN_Text;
			}


			var BIG_BIN = new BigNumber(BIN_Text, 2);
			var HEX_Text = BIG_BIN.toString(16).toUpperCase();
			var PKT_LENGTH = Number(BIN_Text.length) / 8;
			x[1].value = PKT_LENGTH;
			GRAD_LENGTH = PKT_LENGTH;
			BIN_Text = "";
			DEC_Text = "The text in decimal is:";

			k = 0;
			k1 = '';
			if (Grad_Info_CNT > 0) {
				for (var j = Grad_Info_CNT; j >= 1; j--) {
					k = 2 + 3 * (j);
					k1 += k + '-';
					DEC_Text += Number(x[k].value);
					BIN_Text += decToBin(Number(x[k].value), 5);
					DEC_Text += Number(x[k - 1].value);
					BIN_Text += decToBin(Number(x[k - 1].value), 1);
					DEC_Text += Number(x[k - 2].value);
					BIN_Text += decToBin(Number(x[k - 2].value), 15);
				}
			}
			for (let i = 2; i >= 0; i--) {
				DEC_Text += Number(x[i].value);
				BIN_Text += decToBin(Number(x[i].value), Field_Length[i]);
			}

			var Rem1 = 0;
			Rem1 = BIN_Text.length % 8;

			if (Rem1 > 0) {
				Pad = "0";
				for (i = 0; i < 8 - Rem1 - 1; i++)
					Pad += "0";
				BIN_Text = Pad + BIN_Text;
			}


			var BIG_BIN2 = new BigNumber(BIN_Text, 2);
			HEX_Text = BIG_BIN2.toString(16).toUpperCase();
			GRAD = HEX_Text;
			document.getElementById("GRAD_SPKT").innerHTML = DEC_Text + "<br>" +
				"The text in binary is:" + BIN_Text + "<br>" +
				"The Hex Equivalent is: " + HEX_Text + "<br>" +
				"The Packet Length in bytes is:" + PKT_LENGTH + "<br>"
			ChangeStatus();
		}





		function CS_TLI() {
			
			var x = document.getElementById("TLI_SUBPKT");
			const Field_Length = [4, 7, 4, 6];
			var DEC_Text = "The text in decimal is:";
			var BIN_Text = "";
			
			var ROUTE_RFID_CNT = Number(x[3].value);

			//var adj_line_cnt = Number(x[x.length - 7].value);
			
			//var abs_loc_rst = x[x.length - 11].value;
			var abs_loc_rst = Number(x[ROUTE_RFID_CNT * 3 + 4].value);//added
			var adj_line_cnt = Number(x[ROUTE_RFID_CNT * 3 + abs_loc_rst*3+5].value);//added

			
			if (adj_line_cnt > 0){
				for (let i = 0; i <= adj_line_cnt; i++) {
					DEC_Text += Number(x[x.length - i -1].value);
					BIN_Text += decToBin(Number(x[x.length -  i -1].value), 9);	//line tin
				}
				DEC_Text += Number(x[x.length - adj_line_cnt-2].value);
				BIN_Text += decToBin(Number(x[x.length - adj_line_cnt-2].value), 3);
			}
			else {
				DEC_Text += Number(x[x.length - 1].value);
				BIN_Text += decToBin(Number(x[x.length - 1].value), 9);
				DEC_Text += Number(x[x.length - 2].value);
				BIN_Text += decToBin(Number(x[x.length - 2].value), 3);
			}
			//DEC_Text += Number(x[x.length - 7].value);
			//BIN_Text += decToBin(Number(x[x.length - 7].value), 3);
			if (abs_loc_rst > 0) {
				DEC_Text += Number(x[x.length - adj_line_cnt - 3].value);
				BIN_Text += decToBin(Number(x[x.length - adj_line_cnt - 3].value), 23);
				DEC_Text += Number(x[x.length - adj_line_cnt - 4].value);
				BIN_Text += decToBin(Number(x[x.length - adj_line_cnt - 4].value), 2);
				DEC_Text += Number(x[x.length - adj_line_cnt - 5].value);
				BIN_Text += decToBin(Number(x[x.length - adj_line_cnt - 5].value), 15);

				DEC_Text += Number(x[x.length - adj_line_cnt - 6].value);
				BIN_Text += decToBin(Number(x[x.length - adj_line_cnt - 6].value), 1);

			}
			else{
				DEC_Text += Number(x[x.length - adj_line_cnt - 3].value);
				BIN_Text += decToBin(Number(x[x.length - adj_line_cnt - 3].value), 1);
			}
			//DEC_Text += Number(x[x.length - 11].value);
			//BIN_Text += decToBin(Number(x[x.length - 11].value), 2);
			var k = 0;
			var k1 = '';
			if (ROUTE_RFID_CNT > 0 & ROUTE_RFID_CNT < 63) {
				for (var j = ROUTE_RFID_CNT; j >= 1; j--) {
					k = 3 + 3 * (j);
					k1 += k + '-';
					DEC_Text += Number(x[k].value);
					BIN_Text += decToBin(Number(x[k].value), 1);
					DEC_Text += Number(x[k - 1].value);
					BIN_Text += decToBin(Number(x[k - 1].value), 10);
					DEC_Text += Number(x[k - 2].value);
					BIN_Text += decToBin(Number(x[k - 2].value), 11);
				}
			}
			for (var i = 3; i >= 0; i--) {
				DEC_Text += Number(x[i].value);
				BIN_Text += decToBin(Number(x[i].value), Field_Length[i]);
			}
			
			var Rem = 0;
			Rem = BIN_Text.length % 8;

			if (Rem > 0) {
				var Pad = "0";
				for (i = 0; i < 8 - Rem - 1; i++)
					Pad += "0";
				BIN_Text = Pad + BIN_Text;
			}


			var BIG_BIN = new BigNumber(BIN_Text, 2);
			var HEX_Text = BIG_BIN.toString(16).toUpperCase();
			var PKT_LENGTH = Number(BIN_Text.length) / 8;
			x[1].value=PKT_LENGTH;
			TLI_LENGTH = PKT_LENGTH;
			BIN_Text = "";
			DEC_Text = "The text in decimal is:";
			/*if (adj_line_cnt > 1)
				for (let i = adj_line_cnt - 1; i >= 0; i--) {
					DEC_Text += Number(x[x.length - 6 + i].value);
					BIN_Text += decToBin(Number(x[x.length - 6 + i].value), 9);	//line tin
				}
			else {
				DEC_Text += Number(x[x.length - 6].value);
				BIN_Text += decToBin(Number(x[x.length - 6].value), 9);
			}
			DEC_Text += Number(x[x.length - 7].value);
			BIN_Text += decToBin(Number(x[x.length - 7].value), 9);
			if (abs_loc_rst > 0) {
				DEC_Text += Number(x[x.length - 8].value);
				BIN_Text += decToBin(Number(x[x.length - 8].value), 23);
				DEC_Text += Number(x[x.length - 9].value);
				BIN_Text += decToBin(Number(x[x.length - 9].value), 2);
				DEC_Text += Number(x[x.length - 10].value);
				BIN_Text += decToBin(Number(x[x.length - 10].value), 15);

			}
			DEC_Text += Number(x[x.length - 11].value);
			BIN_Text += decToBin(Number(x[x.length - 11].value), 2);
			k = 0;
			k1 = '';
			if (ROUTE_RFID_CNT > 0) {
				for (let j = ROUTE_RFID_CNT; j >= 1; j--) {
					k = 2 + 2 * (j);
					k1 += k + '-';
					DEC_Text += Number(x[k].value);
					BIN_Text += decToBin(Number(x[k].value), 10);
					DEC_Text += Number(x[k - 1].value);
					BIN_Text += decToBin(Number(x[k - 1].value), 11);
				}
			}
			for (let i = 2; i >= 0; i--) {
				DEC_Text += Number(x[i].value);
				BIN_Text += decToBin(Number(x[i].value), Field_Length[i]);
			}*/


			if (adj_line_cnt > 0){
				for (let i = 0; i <= adj_line_cnt; i++) {
					DEC_Text += Number(x[x.length - i -1].value);
					BIN_Text += decToBin(Number(x[x.length -  i -1].value), 9);	//line tin
				}
				DEC_Text += Number(x[x.length - adj_line_cnt-2].value);
				BIN_Text += decToBin(Number(x[x.length - adj_line_cnt-2].value), 3);
			}
			else {
				DEC_Text += Number(x[x.length - 1].value);
				BIN_Text += decToBin(Number(x[x.length - 1].value), 9);
				DEC_Text += Number(x[x.length - 2].value);
				BIN_Text += decToBin(Number(x[x.length - 2].value), 3);
			}
			//DEC_Text += Number(x[x.length - 7].value);
			//BIN_Text += decToBin(Number(x[x.length - 7].value), 3);
			if (abs_loc_rst > 0) {
				DEC_Text += Number(x[x.length - adj_line_cnt - 3].value);
				BIN_Text += decToBin(Number(x[x.length - adj_line_cnt - 3].value), 23);
				DEC_Text += Number(x[x.length - adj_line_cnt - 4].value);
				BIN_Text += decToBin(Number(x[x.length - adj_line_cnt - 4].value), 2);
				DEC_Text += Number(x[x.length - adj_line_cnt - 5].value);
				BIN_Text += decToBin(Number(x[x.length - adj_line_cnt - 5].value), 15);

				DEC_Text += Number(x[x.length - adj_line_cnt - 6].value);
				BIN_Text += decToBin(Number(x[x.length - adj_line_cnt - 6].value), 1);

			}
			else{
				DEC_Text += Number(x[x.length - adj_line_cnt - 3].value);
				BIN_Text += decToBin(Number(x[x.length - adj_line_cnt - 3].value), 1);
			}
			//DEC_Text += Number(x[x.length - 11].value);
			//BIN_Text += decToBin(Number(x[x.length - 11].value), 2);
			var k = 0;
			var k1 = '';
			if (ROUTE_RFID_CNT > 0 & ROUTE_RFID_CNT < 63) {
				for (var j = ROUTE_RFID_CNT; j >= 1; j--) {
					k = 3 + 3 * (j);
					k1 += k + '-';
					DEC_Text += Number(x[k].value);
					BIN_Text += decToBin(Number(x[k].value), 1);
					DEC_Text += Number(x[k - 1].value);
					BIN_Text += decToBin(Number(x[k - 1].value), 10);
					DEC_Text += Number(x[k - 2].value);
					BIN_Text += decToBin(Number(x[k - 2].value), 11);
				}
			}
			for (var i = 3; i >= 0; i--) {
				DEC_Text += Number(x[i].value);
				BIN_Text += decToBin(Number(x[i].value), Field_Length[i]);
			}
			
			Rem = 0;
			Rem = BIN_Text.length % 8;

			if (Rem > 0) {
				Pad = "0";
				for (i = 0; i < 8 - Rem - 1; i++)
					Pad += "0";
				BIN_Text = Pad + BIN_Text;
			}


			var BIG_BIN2 = new BigNumber(BIN_Text, 2);
			HEX_Text = BIG_BIN2.toString(16).toUpperCase();
			TLI = HEX_Text;
			var PKT_LENGTH = (BIN_Text.length) / 8;
			x[1].value = PKT_LENGTH;
			document.getElementById("TLI_SBPKT").innerHTML = DEC_Text + "<br>" +
				"The text in binary is:" + BIN_Text + "<br>" +
				"The text length in binary is:" + BIN_Text.length + "<br>" +
				"The Hex Equivalent is: " + HEX_Text + "<br>" +
				"The Packet Length in bytes is:" + PKT_LENGTH + "<br>" +
				"The Remainder is:" + Rem;
			ChangeStatus();
		}






		/*function CS_TLI() {
			var x = document.getElementById("TLI_SUBPKT");
			const Field_Length = [4, 7, 4, 6];
			var DEC_Text = "The text in decimal is:";
			var BIN_Text = "";
			var ROUTE_RFID_CNT = Number(x[3].value);

			//var adj_line_cnt = Number(x[x.length - 7].value);
			var adj_line_cnt = Number(x[ROUTE_RFID_CNT * 2 + 2 + 5].value);//added
			//var abs_loc_rst = x[x.length - 11].value;
			var abs_loc_rst = Number(x[ROUTE_RFID_CNT * 2 + 2 + 6].value);//added

			console.log("  "+x.length);
			if (adj_line_cnt > 1)
				for (let i = adj_line_cnt - 1; i >= 0; i--) {
					DEC_Text += Number(x[x.length - 6 + i].value);
					BIN_Text += decToBin(Number(x[x.length - 6 + i].value), 9);	//line tin
				}
			else {
				DEC_Text += Number(x[x.length - 6].value);
				BIN_Text += decToBin(Number(x[x.length - 6].value), 9);
			}
			DEC_Text += Number(x[x.length - 7].value);
			BIN_Text += decToBin(Number(x[x.length - 7].value), 3);
			if (abs_loc_rst > 0) {
				DEC_Text += Number(x[x.length - 8].value);
				BIN_Text += decToBin(Number(x[x.length - 8].value), 23);
				DEC_Text += Number(x[x.length - 9].value);
				BIN_Text += decToBin(Number(x[x.length - 9].value), 2);
				DEC_Text += Number(x[x.length - 10].value);
				BIN_Text += decToBin(Number(x[x.length - 10].value), 15);

			}
			DEC_Text += Number(x[x.length - 11].value);
			BIN_Text += decToBin(Number(x[x.length - 11].value), 2);
			var k = 0;
			var k1 = '';
			if (ROUTE_RFID_CNT > 0 & ROUTE_RFID_CNT < 63) {
				for (var j = ROUTE_RFID_CNT; j >= 1; j--) {
					k = 2 + 2 * (j);
					k1 += k + '-';
					DEC_Text += Number(x[k].value);
					BIN_Text += decToBin(Number(x[k].value), 10);
					DEC_Text += Number(x[k - 1].value);
					BIN_Text += decToBin(Number(x[k - 1].value), 11);
				}
			}
			for (var i = 2; i >= 0; i--) {
				DEC_Text += Number(x[i].value);
				BIN_Text += decToBin(Number(x[i].value), Field_Length[i]);
			}
			var Rem = 0;
			Rem = BIN_Text.length % 8;

			if (Rem > 0) {
				var Pad = "0";
				for (i = 0; i < 8 - Rem - 1; i++)
					Pad += "0";
				BIN_Text = Pad + BIN_Text;
			}


			var BIG_BIN = new BigNumber(BIN_Text, 2);
			var HEX_Text = BIG_BIN.toString(16).toUpperCase();
			var PKT_LENGTH = Number(BIN_Text.length) / 8;
			//x[1].value=PKT_LENGTH;
			TLI_LENGTH = PKT_LENGTH;
			BIN_Text = "";
			DEC_Text = "The text in decimal is:";
			if (adj_line_cnt > 1)
				for (let i = adj_line_cnt - 1; i >= 0; i--) {
					DEC_Text += Number(x[x.length - 6 + i].value);
					BIN_Text += decToBin(Number(x[x.length - 6 + i].value), 9);	//line tin
				}
			else {
				DEC_Text += Number(x[x.length - 6].value);
				BIN_Text += decToBin(Number(x[x.length - 6].value), 9);
			}
			DEC_Text += Number(x[x.length - 7].value);
			BIN_Text += decToBin(Number(x[x.length - 7].value), 9);
			if (abs_loc_rst > 0) {
				DEC_Text += Number(x[x.length - 8].value);
				BIN_Text += decToBin(Number(x[x.length - 8].value), 23);
				DEC_Text += Number(x[x.length - 9].value);
				BIN_Text += decToBin(Number(x[x.length - 9].value), 2);
				DEC_Text += Number(x[x.length - 10].value);
				BIN_Text += decToBin(Number(x[x.length - 10].value), 15);

			}
			DEC_Text += Number(x[x.length - 11].value);
			BIN_Text += decToBin(Number(x[x.length - 11].value), 2);
			k = 0;
			k1 = '';
			if (ROUTE_RFID_CNT > 0) {
				for (let j = ROUTE_RFID_CNT; j >= 1; j--) {
					k = 2 + 2 * (j);
					k1 += k + '-';
					DEC_Text += Number(x[k].value);
					BIN_Text += decToBin(Number(x[k].value), 10);
					DEC_Text += Number(x[k - 1].value);
					BIN_Text += decToBin(Number(x[k - 1].value), 11);
				}
			}
			for (let i = 2; i >= 0; i--) {
				DEC_Text += Number(x[i].value);
				BIN_Text += decToBin(Number(x[i].value), Field_Length[i]);
			}

			Rem = 0;
			Rem = BIN_Text.length % 8;

			if (Rem > 0) {
				Pad = "0";
				for (i = 0; i < 8 - Rem - 1; i++)
					Pad += "0";
				BIN_Text = Pad + BIN_Text;
			}


			var BIG_BIN2 = new BigNumber(BIN_Text, 2);
			HEX_Text = BIG_BIN2.toString(16).toUpperCase();
			TLI = HEX_Text;
			var PKT_LENGTH = (BIN_Text.length) / 8;
			x[1].value = PKT_LENGTH;
			document.getElementById("TLI_SBPKT").innerHTML = DEC_Text + "<br>" +
				"The text in binary is:" + BIN_Text + "<br>" +
				"The text length in binary is:" + BIN_Text.length + "<br>" +
				"The Hex Equivalent is: " + HEX_Text + "<br>" +
				"The Packet Length in bytes is:" + PKT_LENGTH + "<br>" +
				"The Remainder is:" + Rem;
			ChangeStatus();
		}*/
		function CS_TCD() {
			var x = document.getElementById("TCD_SUBPKT");
			const Field_Length = [4, 7, 4];
			var DEC_Text = "The text in decimal is:";
			var BIN_Text = "";
			var Track_Cond_CNT = Number(x[2].value);
			var k = 0;
			var k1 = '';
			if (Track_Cond_CNT > 0) {
				for (var j = Track_Cond_CNT; j >= 1; j--) {
					k = 2 + 3 * (j);
					k1 += k + '-';
					DEC_Text += Number(x[k].value);
					BIN_Text += decToBin(Number(x[k].value), 15);
					DEC_Text += Number(x[k - 1].value);
					BIN_Text += decToBin(Number(x[k - 1].value), 15);
					DEC_Text += Number(x[k - 2].value);
					BIN_Text += decToBin(Number(x[k - 2].value), 4);
				}
			}
			for (var i = 2; i >= 0; i--) {
				DEC_Text += Number(x[i].value);
				BIN_Text += decToBin(Number(x[i].value), Field_Length[i]);
			}
			var Rem = 0;
			Rem = BIN_Text.length % 8;

			if (Rem > 0) {
				var Pad = "0";
				for (i = 0; i < 8 - Rem - 1; i++)
					Pad += "0";
				BIN_Text = Pad + BIN_Text;
			}


			var BIG_BIN = new BigNumber(BIN_Text, 2);
			var HEX_Text = BIG_BIN.toString(16).toUpperCase();
			var PKT_LENGTH = Number(BIN_Text.length) / 8;
			x[1].value = PKT_LENGTH;
			TCD_LENGTH = PKT_LENGTH;
			BIN_Text = "";
			DEC_Text = "The text in decimal is:";

			k = 0;
			k1 = '';
			if (Track_Cond_CNT > 0) {
				for (var j = Track_Cond_CNT; j >= 1; j--) {
					k = 2 + 3 * (j);
					k1 += k + '-';
					DEC_Text += Number(x[k].value);
					BIN_Text += decToBin(Number(x[k].value), 15);
					DEC_Text += Number(x[k - 1].value);
					BIN_Text += decToBin(Number(x[k - 1].value), 15);
					DEC_Text += Number(x[k - 2].value);
					BIN_Text += decToBin(Number(x[k - 2].value), 4);
				}
			}
			for (let i = 2; i >= 0; i--) {
				DEC_Text += Number(x[i].value);
				BIN_Text += decToBin(Number(x[i].value), Field_Length[i]);
			}

			Rem = 0;
			Rem = BIN_Text.length % 8;

			if (Rem > 0) {
				Pad = "0";
				for (i = 0; i < 8 - Rem - 1; i++)
					Pad += "0";
				BIN_Text = Pad + BIN_Text;
			}


			var BIG_BIN2 = new BigNumber(BIN_Text, 2);
			HEX_Text = BIG_BIN2.toString(16).toUpperCase();
			TCD = HEX_Text;
			document.getElementById("TCD_SPKT").innerHTML = DEC_Text + "<br>" +
				"The text in binary is:" + BIN_Text + "<br>" +
				"The Hex Equivalent is: " + HEX_Text + "<br>" +
				"The Packet Length in bytes is:" + PKT_LENGTH + "<br>";
			ChangeStatus();
		}
		function CS_SSP() {
			var x = document.getElementById("SSP_SUBPKT");
			const Field_Length = [4, 7, 5];
			var DEC_Text = "The text in decimal is:";
			var BIN_Text = "";
			var Speed_Info_CNT = Number(x[2].value);
			var k = 0;
			var k1 = '';
			if (Speed_Info_CNT > 0) {
				for (var j = Speed_Info_CNT; j >= 1; j--) {
					k = 2 + 3 * (j);
					k1 += k + '-';
					DEC_Text += Number(x[k].value);
					BIN_Text += decToBin(Number(x[k].value), 6);
					DEC_Text += Number(x[k - 1].value);
					BIN_Text += decToBin(Number(x[k - 1].value), 1);
					DEC_Text += Number(x[k - 2].value);
					BIN_Text += decToBin(Number(x[k - 2].value), 15);
				}
			}
			for (var i = 2; i >= 0; i--) {
				DEC_Text += Number(x[i].value);
				BIN_Text += decToBin(Number(x[i].value), Field_Length[i]);
			}
			var Rem = 0;
			Rem = BIN_Text.length % 8;

			if (Rem > 0) {
				var Pad = "0";
				for (i = 0; i < 8 - Rem - 1; i++)
					Pad += "0";
				BIN_Text = Pad + BIN_Text;
			}


			var BIG_BIN = new BigNumber(BIN_Text, 2);
			var HEX_Text = BIG_BIN.toString(16).toUpperCase();
			var PKT_LENGTH = Number(BIN_Text.length) / 8;
			x[1].value = PKT_LENGTH;
			SSP_LENGTH = PKT_LENGTH;
			BIN_Text = "";
			DEC_Text = "The text in decimal is:";

			k = 0;
			k1 = '';
			if (Speed_Info_CNT > 0) {
				for (var j = Speed_Info_CNT; j >= 1; j--) {
					k = 2 + 3 * (j);
					k1 += k + '-';
					DEC_Text += Number(x[k].value);
					BIN_Text += decToBin(Number(x[k].value), 6);
					DEC_Text += Number(x[k - 1].value);
					BIN_Text += decToBin(Number(x[k - 1].value), 1);
					DEC_Text += Number(x[k - 2].value);
					BIN_Text += decToBin(Number(x[k - 2].value), 15);
				}
			}
			for (let i = 2; i >= 0; i--) {
				DEC_Text += Number(x[i].value);
				BIN_Text += decToBin(Number(x[i].value), Field_Length[i]);
			}

			var Rem1 = 0;
			Rem1 = BIN_Text.length % 8;

			if (Rem1 > 0) {
				Pad = "0";
				for (i = 0; i < 8 - Rem1 - 1; i++)
					Pad += "0";
				BIN_Text = Pad + BIN_Text;
			}


			var BIG_BIN2 = new BigNumber(BIN_Text, 2);
			HEX_Text = BIG_BIN2.toString(16).toUpperCase();
			SSP = HEX_Text;
			document.getElementById("SSP_SPKT").innerHTML = DEC_Text + "<br>" +
				"The text in binary is:" + BIN_Text + "<br>" +
				"The Hex Equivalent is: " + HEX_Text + "<br>" +
				"The Packet Length in bytes is:" + PKT_LENGTH + "<br>"
			ChangeStatus();
		}

	</script>




</body>

</html>